npm warn Unknown user config "home". This will stop working in the next major version of npm.

> pptx2pptistjson@2.2.0 test
> npx jest

npm warn Unknown env config "home". This will stop working in the next major version of npm.
npm warn Unknown user config "home". This will stop working in the next major version of npm.
FAIL tests/__tests__/html-output-integrity.test.ts
  ● HTML Output Integrity Tests › Output Format Consistency › should match expected output.json format exactly

    expect(received).toContain(expected) // indexOf

    Expected substring: "color:#5b9bd5ff;font-size:54px;font-weight:bold;--colortype:accent1"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:54px;color:#5b9bd5ff;font-weight:bold;--colortype:accent1\">党建宣传策略实战方法论</span></p></div>"

      384 |       expect(json.content).toContain('<div style="">'); // Note: fixed space
      385 |       expect(json.content).toContain('<p style="">'); // Note: fixed space
    > 386 |       expect(json.content).toContain(
          |                            ^
      387 |         "color:#5b9bd5ff;font-size:54px;font-weight:bold;--colortype:accent1"
      388 |       );
      389 |     });

      at Object.<anonymous> (tests/__tests__/html-output-integrity.test.ts:386:28)

PASS tests/__tests__/services/FileService.test.ts
PASS tests/__tests__/services/ImageDataService.test.ts
  ● Console

    console.warn
      No relationship found for embedId: nonexistent

      39 |       if (!relationship) {
      40 |         DebugHelper.log(context, `No relationship found for embedId: ${embedId}`, "warn");
    > 41 |         console.warn(`No relationship found for embedId: ${embedId}`);
         |                 ^
      42 |         return null;
      43 |       }
      44 |

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:41:17)
      at Object.<anonymous> (tests/__tests__/services/ImageDataService.test.ts:107:41)

    console.error
      Error extracting image data for rId1: Error: Mock file not found: ppt/media/missing.png
          at MockFileService.extractBinaryFileAsBuffer (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/services/ImageDataService.test.ts:24:13)
          at ImageDataService.extractImageData (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:61:45)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/services/ImageDataService.test.ts:119:41)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

       98 |     } catch (error) {
       99 |       DebugHelper.log(context, `Error extracting image data for ${embedId}: ${error}`, "error");
    > 100 |       console.error(`Error extracting image data for ${embedId}:`, error);
          |               ^
      101 |       return null;
      102 |     }
      103 |   }

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:100:15)
      at Object.<anonymous> (tests/__tests__/services/ImageDataService.test.ts:119:22)

    console.warn
      Invalid relationship format for embedId: rId1 { invalidProperty: 'value' }

      50 |         imagePath = relationship.target;
      51 |       } else {
    > 52 |         console.warn(`Invalid relationship format for embedId: ${embedId}`, relationship);
         |                 ^
      53 |         return null;
      54 |       }
      55 |

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:52:17)
      at Object.<anonymous> (tests/__tests__/services/ImageDataService.test.ts:147:41)

    console.error
      Error encoding image to base64: TypeError: Cannot read properties of null (reading 'toString')
          at ImageDataService.encodeToBase64 (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:160:43)
          at /home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/services/ImageDataService.test.ts:332:33
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/expect/build/index.js:1824:9)
          at Object.throwingMatcher [as toThrow] (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/expect/build/index.js:2231:93)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/services/ImageDataService.test.ts:332:60)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      161 |       return `data:${imageData.mimeType};base64,${base64Data}`;
      162 |     } catch (error) {
    > 163 |       console.error('Error encoding image to base64:', error);
          |               ^
      164 |       throw new Error('Failed to encode image to base64');
      165 |     }
      166 |   }

      at ImageDataService.encodeToBase64 (app/lib/services/images/ImageDataService.ts:163:15)
      at tests/__tests__/services/ImageDataService.test.ts:332:33
      at Object.<anonymous> (node_modules/expect/build/index.js:1824:9)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:2231:93)
      at Object.<anonymous> (tests/__tests__/services/ImageDataService.test.ts:332:60)

    console.error
      Error extracting image data for rId2: Error: Mock file not found: ppt/media/missing.png
          at MockFileService.extractBinaryFileAsBuffer (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/services/ImageDataService.test.ts:24:13)
          at ImageDataService.extractImageData (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:61:45)
          at /home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:182:42
          at tryAcquire (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:333:11)
          at /home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:348:7
          at new Promise (<anonymous>)
          at Semaphore.acquire (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:329:12)
          at /home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:180:25
          at Array.map (<anonymous>)
          at ImageDataService.processBatch (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:179:16)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/services/ImageDataService.test.ts:375:42)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

       98 |     } catch (error) {
       99 |       DebugHelper.log(context, `Error extracting image data for ${embedId}: ${error}`, "error");
    > 100 |       console.error(`Error extracting image data for ${embedId}:`, error);
          |               ^
      101 |       return null;
      102 |     }
      103 |   }

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:100:15)
      at app/lib/services/images/ImageDataService.ts:182:31

FAIL tests/__tests__/html-converter-comprehensive.test.ts
  ● HtmlConverter - Comprehensive Test Suite › Single Paragraph Conversion › should convert simple text content to HTML

    expect(received).toBe(expected) // Object.is equality

    Expected: "<div style=\"\"><p style=\"\"><span style=\"\">Hello World</span></p></div>"
    Received: "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">Hello World</span></p></div>"

      15 |       
      16 |       const html = HtmlConverter.convertSingleParagraphToHtml(content);
    > 17 |       expect(html).toBe('<div style=""><p style=""><span style="">Hello World</span></p></div>');
         |                    ^
      18 |     });
      19 |
      20 |     it('should handle text with basic styling', () => {

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:17:20)

  ● HtmlConverter - Comprehensive Test Suite › Single Paragraph Conversion › should handle multiple text runs in a paragraph

    expect(received).toContain(expected) // indexOf

    Expected substring: "<span style=\"\">Normal </span>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">Normal </span><span style=\"font-size:23.99px;font-weight:bold\">Bold </span><span style=\"font-size:23.99px;font-style:italic\">Italic</span></p></div>"

      78 |       
      79 |       const html = HtmlConverter.convertSingleParagraphToHtml(content);
    > 80 |       expect(html).toContain('<span style="">Normal </span>');
         |                    ^
      81 |       expect(html).toContain('<span style="font-weight:bold">Bold </span>');
      82 |       expect(html).toContain('<span style="font-style:italic">Italic</span>');
      83 |     });

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:80:20)

  ● HtmlConverter - Comprehensive Test Suite › Single Paragraph Conversion › should handle options without wrapping div

    expect(received).toBe(expected) // Object.is equality

    Expected: "<p style=\"\"><span style=\"\">No Wrapper</span></p>"
    Received: "<p style=\"\"><span style=\"font-size:23.99px\">No Wrapper</span></p>"

      90 |       const options: HtmlConversionOptions = { wrapInDiv: false };
      91 |       const html = HtmlConverter.convertSingleParagraphToHtml(content, options);
    > 92 |       expect(html).toBe('<p style=""><span style="">No Wrapper</span></p>');
         |                    ^
      93 |     });
      94 |
      95 |     it('should handle custom div style', () => {

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:92:20)

  ● HtmlConverter - Comprehensive Test Suite › Multiple Paragraphs Conversion › should convert multiple paragraphs to HTML

    expect(received).toContain(expected) // indexOf

    Expected substring: "<p style=\"\"><span style=\"\">First paragraph</span></p>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">First paragraph</span></p><p style=\"\"><span style=\"font-size:23.99px\">Second paragraph</span></p><p style=\"\"><span style=\"font-size:23.99px\">Third paragraph</span></p></div>"

      142 |       
      143 |       const html = HtmlConverter.convertParagraphsToHtml(paragraphs);
    > 144 |       expect(html).toContain('<p style=""><span style="">First paragraph</span></p>');
          |                    ^
      145 |       expect(html).toContain('<p style=""><span style="">Second paragraph</span></p>');
      146 |       expect(html).toContain('<p style=""><span style="">Third paragraph</span></p>');
      147 |     });

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:144:20)

  ● HtmlConverter - Comprehensive Test Suite › Multiple Paragraphs Conversion › should handle mixed paragraph styles

    expect(received).toContain(expected) // indexOf

    Expected substring: "<span style=\"\">Normal</span>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">Normal</span></p><p style=\"\"><span style=\"font-size:23.99px;font-weight:bold\">Bold</span></p><p style=\"\"><span style=\"font-size:23.99px;font-style:italic\">Italic</span></p></div>"

      155 |       
      156 |       const html = HtmlConverter.convertParagraphsToHtml(paragraphs);
    > 157 |       expect(html).toContain('<span style="">Normal</span>');
          |                    ^
      158 |       expect(html).toContain('<span style="font-weight:bold">Bold</span>');
      159 |       expect(html).toContain('<span style="font-style:italic">Italic</span>');
      160 |     });

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:157:20)

  ● HtmlConverter - Comprehensive Test Suite › Multiple Paragraphs Conversion › should handle options without wrapping div for multiple paragraphs

    expect(received).toBe(expected) // Object.is equality

    Expected: "<p style=\"\"><span style=\"\">Para 1</span></p><p style=\"\"><span style=\"\">Para 2</span></p>"
    Received: "<p style=\"\"><span style=\"font-size:23.99px\">Para 1</span></p><p style=\"\"><span style=\"font-size:23.99px\">Para 2</span></p>"

      194 |       const options: HtmlConversionOptions = { wrapInDiv: false };
      195 |       const html = HtmlConverter.convertParagraphsToHtml(paragraphs, options);
    > 196 |       expect(html).toBe('<p style=""><span style="">Para 1</span></p><p style=""><span style="">Para 2</span></p>');
          |                    ^
      197 |     });
      198 |   });
      199 |

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:196:20)

  ● HtmlConverter - Comprehensive Test Suite › HTML Escaping › should handle null and undefined text gracefully

    expect(received).toContain(expected) // indexOf

    Expected substring: "<span style=\"\"></span>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\"></span></p></div>"

      308 |       const options: HtmlConversionOptions = { escapeHtml: true };
      309 |       const html = HtmlConverter.convertSingleParagraphToHtml(content, options);
    > 310 |       expect(html).toContain('<span style=""></span>');
          |                    ^
      311 |     });
      312 |   });
      313 |

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:310:20)

  ● HtmlConverter - Comprehensive Test Suite › Style Ordering and Formatting › should maintain correct style order

    expect(received).toContain(expected) // indexOf

    Expected substring: "color:"
    Received string:    "font-size:16px"

      337 |       const styles = styleContent.split(';');
      338 |       
    > 339 |       expect(styles[0]).toContain('color:');
          |                         ^
      340 |       expect(styles[1]).toContain('font-size:');
      341 |       expect(styles[2]).toContain('font-weight:');
      342 |       expect(styles[3]).toContain('font-style:');

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:339:25)

  ● HtmlConverter - Comprehensive Test Suite › Edge Cases and Error Handling › should handle content with only empty text

    expect(received).toBe(expected) // Object.is equality

    Expected: "<div style=\"\"><p style=\"\"><span style=\"\"></span></p></div>"
    Received: "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\"></span></p></div>"

      448 |       
      449 |       const html = HtmlConverter.convertSingleParagraphToHtml(content);
    > 450 |       expect(html).toBe('<div style=""><p style=""><span style=""></span></p></div>');
          |                    ^
      451 |     });
      452 |
      453 |     it('should handle content with only whitespace', () => {

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:450:20)

  ● HtmlConverter - Comprehensive Test Suite › Edge Cases and Error Handling › should handle content with only whitespace

    expect(received).toContain(expected) // indexOf

    Expected substring: "<span style=\"\">   </span>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">   </span></p></div>"

      457 |       
      458 |       const html = HtmlConverter.convertSingleParagraphToHtml(content);
    > 459 |       expect(html).toContain('<span style="">   </span>');
          |                    ^
      460 |     });
      461 |
      462 |     it('should handle very long text content', () => {

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:459:20)

PASS tests/__tests__/font-size-calculator-comprehensive.test.ts
PASS tests/__tests__/color-utils-comprehensive.test.ts
PASS tests/pptx-parser-integration.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:pic - Name: "Image 0", ID: 9, HasBlipFill: true

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.warn
      FillRect would cause division by zero in ImageElement FtOlD2lHpq: {
        left: 0.29807407407407405,
        top: 0.3317991769547326,
        right: 0.7019259259259258,
        bottom: 0.6682008230452674,
        widthDenominator: 1.1102230246251565e-16,
        heightDenominator: 0
      }

      126 |       
      127 |       if (widthDenominator <= 0.001 || heightDenominator <= 0.001) {
    > 128 |         console.warn(`FillRect would cause division by zero in ImageElement ${this.id}:`, {
          |                 ^
      129 |           left, top, right, bottom,
      130 |           widthDenominator, heightDenominator
      131 |         });

      at ImageElement.getStretchInfo (app/lib/models/domain/elements/ImageElement.ts:128:17)
      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:82:40)
      at ImageProcessor.process (app/lib/services/element/processors/ImageProcessor.ts:266:11)
      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:243:26)
      at SlideParser.parseElements (app/lib/services/parsing/SlideParser.ts:196:28)
      at SlideParser.parse (app/lib/services/parsing/SlideParser.ts:76:24)
      at PresentationParser.parse (app/lib/services/parsing/PresentationParser.ts:70:25)
      at InternalPPTXParser.parse (app/lib/parser/InternalPPTXParser.ts:124:35)
      at InternalPPTXParser.parseToJSON (app/lib/parser/InternalPPTXParser.ts:158:20)
      at parse (app/lib/pptxtojson.ts:11:18)
      at Object.<anonymous> (tests/pptx-parser-integration.test.ts:30:22)

    console.log
      [Slide 1] Processed as image

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 6", ID: 9, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 7", ID: 10, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 8", ID: 11, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 9", ID: 12, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 10", ID: 13, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 11", ID: 14, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 12", ID: 15, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 13", ID: 16, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 0", ID: 2, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 1", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      Slide 1 has 7 elements

      at tests/pptx-parser-integration.test.ts:132:17
          at Array.forEach (<anonymous>)

    console.log
      Slide 1: 0 elements with text content, 3 text type elements

      at tests/pptx-parser-integration.test.ts:143:17
          at Array.forEach (<anonymous>)

    console.log
      Slide 2 has 14 elements

      at tests/pptx-parser-integration.test.ts:132:17
          at Array.forEach (<anonymous>)

    console.log
      Slide 2: 0 elements with text content, 14 text type elements

      at tests/pptx-parser-integration.test.ts:143:17
          at Array.forEach (<anonymous>)

    console.log
      Slide 3 has 2 elements

      at tests/pptx-parser-integration.test.ts:132:17
          at Array.forEach (<anonymous>)

    console.log
      Slide 3: 0 elements with text content, 2 text type elements

      at tests/pptx-parser-integration.test.ts:143:17
          at Array.forEach (<anonymous>)

    console.log
      Total elements across all slides: 23

      at Object.<anonymous> (tests/pptx-parser-integration.test.ts:163:15)

    console.log
      Has text elements: false

      at Object.<anonymous> (tests/pptx-parser-integration.test.ts:164:15)

    console.warn
      ⚠️ No text elements found but slides have other elements. This might indicate a text parsing issue.

      166 |       // 如果有元素但没有文本元素，给出警告而不是失败
      167 |       if (totalElements > 0 && !hasTextElements) {
    > 168 |         console.warn('⚠️ No text elements found but slides have other elements. This might indicate a text parsing issue.');
          |                 ^
      169 |       }
      170 |       
      171 |       // 只有当完全没有元素时才失败

      at Object.<anonymous> (tests/pptx-parser-integration.test.ts:168:17)

PASS tests/__tests__/api-route-parse-pptx.test.ts
PASS tests/element-types.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:pic - Name: "Image 0", ID: 9, HasBlipFill: true

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.warn
      FillRect would cause division by zero in ImageElement I4OWkGiuXm: {
        left: 0.29807407407407405,
        top: 0.3317991769547326,
        right: 0.7019259259259258,
        bottom: 0.6682008230452674,
        widthDenominator: 1.1102230246251565e-16,
        heightDenominator: 0
      }

      126 |       
      127 |       if (widthDenominator <= 0.001 || heightDenominator <= 0.001) {
    > 128 |         console.warn(`FillRect would cause division by zero in ImageElement ${this.id}:`, {
          |                 ^
      129 |           left, top, right, bottom,
      130 |           widthDenominator, heightDenominator
      131 |         });

      at ImageElement.getStretchInfo (app/lib/models/domain/elements/ImageElement.ts:128:17)
      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:82:40)
      at ImageProcessor.process (app/lib/services/element/processors/ImageProcessor.ts:266:11)
      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:243:26)
      at SlideParser.parseElements (app/lib/services/parsing/SlideParser.ts:196:28)
      at SlideParser.parse (app/lib/services/parsing/SlideParser.ts:76:24)
      at PresentationParser.parse (app/lib/services/parsing/PresentationParser.ts:70:25)
      at InternalPPTXParser.parse (app/lib/parser/InternalPPTXParser.ts:124:35)
      at InternalPPTXParser.parseToJSON (app/lib/parser/InternalPPTXParser.ts:158:20)
      at parse (app/lib/pptxtojson.ts:11:18)
      at Object.<anonymous> (tests/element-types.test.ts:21:22)

    console.log
      [Slide 1] Processed as image

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 6", ID: 9, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 7", ID: 10, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 8", ID: 11, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 9", ID: 12, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 10", ID: 13, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 11", ID: 14, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 12", ID: 15, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 13", ID: 16, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 0", ID: 2, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 1", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      Total elements: 23, Elements with text: 0

      at Object.<anonymous> (tests/element-types.test.ts:42:15)

    console.log
      Element 0: type=text, hasText=false, textContent=none...

      at tests/element-types.test.ts:46:17
          at Array.forEach (<anonymous>)

    console.log
      Element 1: type=text, hasText=false, textContent=none...

      at tests/element-types.test.ts:46:17
          at Array.forEach (<anonymous>)

    console.log
      Element 2: type=text, hasText=false, textContent=none...

      at tests/element-types.test.ts:46:17
          at Array.forEach (<anonymous>)

    console.warn
      ⚠️ No text content found in elements. This might indicate a text parsing issue.

      49 |       // 如果没有文本元素但有其他元素，只给出警告
      50 |       if (actualElementsWithText.length === 0 && allElements.length > 0) {
    > 51 |         console.warn('⚠️ No text content found in elements. This might indicate a text parsing issue.');
         |                 ^
      52 |         return; // 跳过后续检查
      53 |       }
      54 |       

      at Object.<anonymous> (tests/element-types.test.ts:51:17)

PASS tests/output-comparison.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:pic - Name: "Image 0", ID: 9, HasBlipFill: true

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.warn
      FillRect would cause division by zero in ImageElement H4-0CVdA_g: {
        left: 0.29807407407407405,
        top: 0.3317991769547326,
        right: 0.7019259259259258,
        bottom: 0.6682008230452674,
        widthDenominator: 1.1102230246251565e-16,
        heightDenominator: 0
      }

      126 |       
      127 |       if (widthDenominator <= 0.001 || heightDenominator <= 0.001) {
    > 128 |         console.warn(`FillRect would cause division by zero in ImageElement ${this.id}:`, {
          |                 ^
      129 |           left, top, right, bottom,
      130 |           widthDenominator, heightDenominator
      131 |         });

      at ImageElement.getStretchInfo (app/lib/models/domain/elements/ImageElement.ts:128:17)
      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:82:40)
      at ImageProcessor.process (app/lib/services/element/processors/ImageProcessor.ts:266:11)
      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:243:26)
      at SlideParser.parseElements (app/lib/services/parsing/SlideParser.ts:196:28)
      at SlideParser.parse (app/lib/services/parsing/SlideParser.ts:76:24)
      at PresentationParser.parse (app/lib/services/parsing/PresentationParser.ts:70:25)
      at InternalPPTXParser.parse (app/lib/parser/InternalPPTXParser.ts:124:35)
      at InternalPPTXParser.parseToJSON (app/lib/parser/InternalPPTXParser.ts:158:20)
      at parse (app/lib/pptxtojson.ts:11:18)
      at Object.<anonymous> (tests/output-comparison.test.ts:21:22)

    console.log
      [Slide 1] Processed as image

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 6", ID: 9, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 7", ID: 10, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 8", ID: 11, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 9", ID: 12, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 10", ID: 13, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 11", ID: 14, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 12", ID: 15, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 13", ID: 16, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 0", ID: 2, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 1", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      期望输出结构: { slides: 3, theme: true, title: true }

      at Object.<anonymous> (tests/output-comparison.test.ts:23:15)

    console.log
      实际输出结构: { slides: 3, theme: true, slideSize: false, metadata: false }

      at Object.<anonymous> (tests/output-comparison.test.ts:29:15)

    console.log
      
      === 元素尺寸比较详情 ===

      at Object.<anonymous> (tests/output-comparison.test.ts:50:15)

    console.log
      
      幻灯片 1:

      at tests/output-comparison.test.ts:58:19
          at Array.forEach (<anonymous>)

    console.log
        元素数量 - 期望: 7, 实际: 7

      at tests/output-comparison.test.ts:64:19
          at Array.forEach (<anonymous>)

    console.log
        元素 1 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (69.34518477439033, 161.45814757440397), 实际: (66.57, 155)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 551.7620816615959 x 182, 实际: 529.69 x 174.72

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 22.072081661595803px, 高度: 7.280000000000001px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 2 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (69.34518477439033, 351.68421628670393), 实际: (66.57, 337.62)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 379.1841004184101 x 53, 实际: 364.02 x 50.88

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 15.1641004184101px, 高度: 2.1199999999999974px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 3 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (69.34518477439033, 398.56480025383394), 实际: (66.57, 382.62)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 266.0220168414701 x 50, 实际: 255.38 x 48

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 10.642016841470081px, 高度: 2px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 4 (shape):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (82.11631209789874, 121.40953099047117), 实际: (78.83170406595276, 116.55317293918898)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 20 x 20, 实际: 19.199999520000002 x 19.199999520000002

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 0.8000004799999978px, 高度: 0.8000004799999978px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
        元素 5 (shape):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (120.77310027868378, 121.40953099047117), 实际: (115.94214933241733, 116.55317293918898)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 20 x 20, 实际: 19.199999520000002 x 19.199999520000002

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 0.8000004799999978px, 高度: 0.8000004799999978px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
        元素 6 (shape):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (159.4298884594688, 121.40953099047117), 实际: (153.0526995857559, 116.55317293918898)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 20 x 20, 实际: 19.199999520000002 x 19.199999520000002

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 0.8000004799999978px, 高度: 0.8000004799999978px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
        元素 7 (image):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (419.16567695962, 262.46271984964926), 实际: (402.4, 251.96)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 231.44299287410928 x 231.44299287410928, 实际: 222.1852962826378 x 222.1852962826378

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 9.257696591471472px, 高度: 9.257696591471472px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
      
      幻灯片 2:

      at tests/output-comparison.test.ts:58:19
          at Array.forEach (<anonymous>)

    console.log
        元素数量 - 期望: 14, 实际: 14

      at tests/output-comparison.test.ts:64:19
          at Array.forEach (<anonymous>)

    console.log
        元素 1 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (264.15094339622647, 46.42254343030217), 实际: (253.58, 44.57)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 471.6981132075471 x 119, 实际: 452.83 x 114.24

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 18.86811320754714px, 高度: 4.760000000000005px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 2 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (408.35777126099714, 74.92385576626017), 实际: (392.02, 71.93)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 183.28445747800583 x 80, 实际: 175.95 x 76.8

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 7.334457478005845px, 高度: 3.200000000000003px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 3 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (166.25130482955814, 197.97843137254893), 实际: (159.6, 190.06)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 354 x 56, 实际: 339.84 x 53.76

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 14.160000000000025px, 高度: 2.240000000000002px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 4 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (105.73535063775813, 192.73321763008892), 实际: (101.51, 185.02)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 78 x 68, 实际: 74.88 x 65.28

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 3.1200000000000045px, 高度: 2.719999999999999px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
        元素 5 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (583.4391493876715, 197.97843137254893), 实际: (560.1, 190.06)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 353.9867292795341 x 56, 实际: 339.83 x 53.76

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 14.15672927953409px, 高度: 2.240000000000002px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 6 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (522.9231951958715, 192.73321763008892), 实际: (502.01, 185.02)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 78 x 68, 实际: 74.88 x 65.28

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 3.1200000000000045px, 高度: 2.719999999999999px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
        元素 7 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (166.26795391977294, 266.7117647058823), 实际: (159.62, 256.04)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 354 x 56, 实际: 339.84 x 53.76

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 14.160000000000025px, 高度: 2.240000000000002px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 8 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (105.75199972797293, 261.46655096342226), 实际: (101.52, 251.01)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 78 x 68, 实际: 74.88 x 65.28

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 3.1200000000000045px, 高度: 2.719999999999999px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
        元素 9 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (583.4258786672056, 266.7117647058823), 实际: (560.09, 256.04)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 354 x 56, 实际: 339.84 x 53.76

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 14.160000000000025px, 高度: 2.240000000000002px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 10 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (522.9099244754055, 261.46655096342226), 实际: (501.99, 251.01)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 78 x 68, 实际: 74.88 x 65.28

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 3.1200000000000045px, 高度: 2.719999999999999px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
        元素 11 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (166.26000048173208, 335.44509803921585), 实际: (159.61, 322.03)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 354 x 56, 实际: 339.84 x 53.76

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 14.160000000000025px, 高度: 2.240000000000002px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 12 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (105.74404628993207, 330.19988429675584), 实际: (101.51, 316.99)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 78 x 68, 实际: 74.88 x 65.28

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 3.1200000000000045px, 高度: 2.719999999999999px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
        元素 13 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (583.4258786672056, 335.44509803921585), 实际: (560.09, 322.03)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 354 x 56, 实际: 339.84 x 53.76

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 14.160000000000025px, 高度: 2.240000000000002px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
        元素 14 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (522.9099244754055, 330.19988429675584), 实际: (501.99, 316.99)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 78 x 68, 实际: 74.88 x 65.28

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 3.1200000000000045px, 高度: 2.719999999999999px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
      
      幻灯片 3:

      at tests/output-comparison.test.ts:58:19
          at Array.forEach (<anonymous>)

    console.log
        元素数量 - 期望: 2, 实际: 2

      at tests/output-comparison.test.ts:64:19
          at Array.forEach (<anonymous>)

    console.log
        元素 1 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (83.99018920344875, 146.26312335958005), 实际: (80.63, 140.41)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 81.06930335998075 x 60, 实际: 77.83 x 57.6

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 3.2393033599807524px, 高度: 2.3999999999999986px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ✅ 尺寸在可接受范围内

      at tests/output-comparison.test.ts:102:23
          at Array.forEach (<anonymous>)

    console.log
        元素 2 (text):

      at tests/output-comparison.test.ts:77:21
          at Array.forEach (<anonymous>)

    console.log
          位置 - 期望: (87.99018920344875, 223.75218722659667), 实际: (84.47, 214.8)

      at tests/output-comparison.test.ts:78:21
          at Array.forEach (<anonymous>)

    console.log
          尺寸 - 期望: 552.9306934242244 x 80, 实际: 530.81 x 76.8

      at tests/output-comparison.test.ts:81:21
          at Array.forEach (<anonymous>)

    console.log
          差异 - 宽度: 22.12069342422444px, 高度: 3.200000000000003px

      at tests/output-comparison.test.ts:93:21
          at Array.forEach (<anonymous>)

    console.log
          ❌ 尺寸差异超出容差范围 (±5px)

      at tests/output-comparison.test.ts:100:23
          at Array.forEach (<anonymous>)

    console.log
      
      === 总结 ===

      at Object.<anonymous> (tests/output-comparison.test.ts:108:15)

    console.log
      总匹配元素: 23

      at Object.<anonymous> (tests/output-comparison.test.ts:109:15)

    console.log
      尺寸不匹配: 13

      at Object.<anonymous> (tests/output-comparison.test.ts:110:15)

    console.log
      匹配率: 43.5%

      at Object.<anonymous> (tests/output-comparison.test.ts:111:15)

    console.log
      幻灯片 1: 期望 7 个元素, 实际 7 个

      at tests/output-comparison.test.ts:146:17
          at Array.forEach (<anonymous>)

    console.log
      幻灯片 2: 期望 14 个元素, 实际 14 个

      at tests/output-comparison.test.ts:146:17
          at Array.forEach (<anonymous>)

    console.log
      幻灯片 3: 期望 2 个元素, 实际 2 个

      at tests/output-comparison.test.ts:146:17
          at Array.forEach (<anonymous>)

    console.log
      颜色 dk1: 期望 rgba(0,7,15,1), 实际 #000000

      at tests/output-comparison.test.ts:177:21
          at Array.forEach (<anonymous>)

    console.log
      颜色 lt1: 期望 #FFFFFF, 实际 #FFFFFF

      at tests/output-comparison.test.ts:177:21
          at Array.forEach (<anonymous>)

    console.log
      颜色 accent1: 期望 rgba(0,7,15,1), 实际 #4472C4

      at tests/output-comparison.test.ts:177:21
          at Array.forEach (<anonymous>)

    console.log
      颜色 accent2: 期望 #16a2ffff, 实际 #ED7D31

      at tests/output-comparison.test.ts:177:21
          at Array.forEach (<anonymous>)

    console.log
      实际第一张幻灯片的文本元素内容：

      at Object.<anonymous> (tests/output-comparison.test.ts:208:17)

    console.log
      首页标题元素: 期望 0, 实际 0

      at Object.<anonymous> (tests/output-comparison.test.ts:215:17)

    console.warn
      ❗ 跳过标题元素检查，因为实际输出中没有解析到文本内容

      221 |           expect(actualTitleElements.length).toBeGreaterThan(0);
      222 |         } else {
    > 223 |           console.warn('❗ 跳过标题元素检查，因为实际输出中没有解析到文本内容');
          |                   ^
      224 |         }
      225 |
      226 |         if (

      at Object.<anonymous> (tests/output-comparison.test.ts:223:19)

    console.log
      目录编号: 期望 0, 实际 0

      at Object.<anonymous> (tests/output-comparison.test.ts:266:17)

    console.log
      目录项目: 期望 0, 实际 0

      at Object.<anonymous> (tests/output-comparison.test.ts:290:17)

    console.warn
      ⚠️ No TOC items found. This might be due to text parsing issues or different slide content.

      294 |         // 如果目录页没有文本内容，可能是因为文本解析问题，给出警告而不是失败
      295 |         if (actualTocItems.length === 0) {
    > 296 |           console.warn('⚠️ No TOC items found. This might be due to text parsing issues or different slide content.');
          |                   ^
      297 |           // 检查是否至少有元素存在
      298 |           expect(actualTocSlide.elements.length).toBeGreaterThan(0);
      299 |         } else {

      at Object.<anonymous> (tests/output-comparison.test.ts:296:19)

    console.log
      形状: 期望 3, 实际 3

      at Object.<anonymous> (tests/output-comparison.test.ts:322:17)

    console.log
      图像: 期望 1, 实际 1

      at Object.<anonymous> (tests/output-comparison.test.ts:364:15)

    console.log
      总元素数: 期望 23, 实际 23

      at Object.<anonymous> (tests/output-comparison.test.ts:501:15)

    console.log
      中文文本元素: 0 / 0

      at Object.<anonymous> (tests/output-comparison.test.ts:525:15)

    console.warn
      ⚠️ No text elements found. This might be due to text parsing issues.

      529 |       // 如果没有找到文本元素，可能是文本解析问题
      530 |       if (textElements.length === 0) {
    > 531 |         console.warn('⚠️ No text elements found. This might be due to text parsing issues.');
          |                 ^
      532 |         // 检查是否至少有其他类型的元素
      533 |         const allElements = actualOutput.slides.flatMap((slide: any) => slide.elements);
      534 |         expect(allElements.length).toBeGreaterThan(0);

      at Object.<anonymous> (tests/output-comparison.test.ts:531:17)

PASS tests/__tests__/negative-offset-handling.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 1600x1067

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 1349.9629058834726x759.2916345610157

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: -0.04881, top: 0.06029, right: 0.30709, bottom: 0.06029 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-255Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-255Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 1349.9629058834726, height: 759.2916345610157 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 1600x1067 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 1349.9629058834726x759.2916345610157

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L-4.881% T6.029% R30.709% B6.029%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 1001.3x667.7

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L-66px T46px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 1001x668

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(-66, 46), display(1001x668)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔧 Handling negative offsets: L-66px T46px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:423:17)

    console.log
      ✂️ Cropped image: 935x668 from (66,0)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:470:19)

    console.log
      🔲 Composited at: L0px T46px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:473:19)

    console.log
      📋 Final image size: 1350x759

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 1349.9629058834726x759.2916345610157

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [
        'fillRect stretch: {"left":-0.04881,"top":0.06029,"right":0.30709,"bottom":0.06029}',
        'transparent padding: Applied fillRect transform'
      ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-394Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-394Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 100x100

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: -0.1, top: -0.2, right: 0.1, bottom: 0.1 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-466Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-466Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 200, height: 150 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 100x100 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L-10.000% T-20.000% R10.000% B10.000%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 200.0x165.0

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L-20px T-30px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 200x165

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(-20, -30), display(200x165)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔧 Handling negative offsets: L-20px T-30px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:423:17)

    console.log
      ✂️ Cropped image: 180x135 from (20,30)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:470:19)

    console.log
      🔲 Composited at: L0px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:473:19)

    console.log
      📋 Final image size: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [
        'fillRect stretch: {"left":-0.1,"top":-0.2,"right":0.1,"bottom":0.1}',
        'transparent padding: Applied fillRect transform'
      ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-489Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-489Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 100x100

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: -0.1, top: -0.1, right: -0.1, bottom: -0.1 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-499Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-499Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 200, height: 150 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 100x100 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L-10.000% T-10.000% R-10.000% B-10.000%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 240.0x180.0

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L-20px T-15px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 240x180

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(-20, -15), display(240x180)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔧 Handling negative offsets: L-20px T-15px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:423:17)

    console.log
      ✂️ Cropped image: 200x150 from (20,15)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:470:19)

    console.log
      🔲 Composited at: L0px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:473:19)

    console.log
      📋 Final image size: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [
        'fillRect stretch: {"left":-0.1,"top":-0.1,"right":-0.1,"bottom":-0.1}',
        'transparent padding: Applied fillRect transform'
      ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-531Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-531Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

PASS tests/dimension-analysis.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:pic - Name: "Image 0", ID: 9, HasBlipFill: true

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.warn
      FillRect would cause division by zero in ImageElement l1-mmCyQ2S: {
        left: 0.29807407407407405,
        top: 0.3317991769547326,
        right: 0.7019259259259258,
        bottom: 0.6682008230452674,
        widthDenominator: 1.1102230246251565e-16,
        heightDenominator: 0
      }

      126 |       
      127 |       if (widthDenominator <= 0.001 || heightDenominator <= 0.001) {
    > 128 |         console.warn(`FillRect would cause division by zero in ImageElement ${this.id}:`, {
          |                 ^
      129 |           left, top, right, bottom,
      130 |           widthDenominator, heightDenominator
      131 |         });

      at ImageElement.getStretchInfo (app/lib/models/domain/elements/ImageElement.ts:128:17)
      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:82:40)
      at ImageProcessor.process (app/lib/services/element/processors/ImageProcessor.ts:266:11)
      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:243:26)
      at SlideParser.parseElements (app/lib/services/parsing/SlideParser.ts:196:28)
      at SlideParser.parse (app/lib/services/parsing/SlideParser.ts:76:24)
      at PresentationParser.parse (app/lib/services/parsing/PresentationParser.ts:70:25)
      at InternalPPTXParser.parse (app/lib/parser/InternalPPTXParser.ts:124:35)
      at InternalPPTXParser.parseToJSON (app/lib/parser/InternalPPTXParser.ts:158:20)
      at parse (app/lib/pptxtojson.ts:11:18)
      at Object.<anonymous> (tests/dimension-analysis.test.ts:21:22)

    console.log
      [Slide 1] Processed as image

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 6", ID: 9, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 7", ID: 10, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 8", ID: 11, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 9", ID: 12, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 10", ID: 13, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 11", ID: 14, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 12", ID: 15, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 13", ID: 16, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 0", ID: 2, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 1", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      
      === 尺寸转换分析报告 ===

      at Object.<anonymous> (tests/dimension-analysis.test.ts:34:15)

    console.log
      幻灯片 1:

      at tests/dimension-analysis.test.ts:53:19
          at Array.forEach (<anonymous>)

    console.log
        元素 1 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 551.8 × 182.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 529.7 × 174.7

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -22.1px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -7.3px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 2 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 379.2 × 53.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 364.0 × 50.9

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -15.2px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.1px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 3 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 266.0 × 50.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 255.4 × 48.0

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -10.6px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.0px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 4 (shape):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 20.0 × 20.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 19.2 × 19.2

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -0.8px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -0.8px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 5 (shape):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 20.0 × 20.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 19.2 × 19.2

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -0.8px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -0.8px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 6 (shape):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 20.0 × 20.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 19.2 × 19.2

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -0.8px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -0.8px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 7 (image):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 231.4 × 231.4

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 222.2 × 222.2

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -9.3px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -9.3px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
      幻灯片 2:

      at tests/dimension-analysis.test.ts:53:19
          at Array.forEach (<anonymous>)

    console.log
        元素 1 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 471.7 × 119.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 452.8 × 114.2

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -18.9px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -4.8px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 2 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 183.3 × 80.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 175.9 × 76.8

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -7.3px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -3.2px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 3 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 354.0 × 56.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 339.8 × 53.8

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -14.2px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.2px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 4 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 78.0 × 68.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 74.9 × 65.3

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -3.1px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.7px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 5 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 354.0 × 56.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 339.8 × 53.8

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -14.2px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.2px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 6 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 78.0 × 68.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 74.9 × 65.3

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -3.1px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.7px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 7 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 354.0 × 56.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 339.8 × 53.8

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -14.2px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.2px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 8 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 78.0 × 68.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 74.9 × 65.3

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -3.1px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.7px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 9 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 354.0 × 56.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 339.8 × 53.8

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -14.2px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.2px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 10 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 78.0 × 68.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 74.9 × 65.3

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -3.1px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.7px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 11 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 354.0 × 56.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 339.8 × 53.8

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -14.2px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.2px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 12 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 78.0 × 68.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 74.9 × 65.3

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -3.1px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.7px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 13 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 354.0 × 56.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 339.8 × 53.8

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -14.2px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.2px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 14 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 78.0 × 68.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 74.9 × 65.3

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -3.1px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.7px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
      幻灯片 3:

      at tests/dimension-analysis.test.ts:53:19
          at Array.forEach (<anonymous>)

    console.log
        元素 1 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 81.1 × 60.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 77.8 × 57.6

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -3.2px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -2.4px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
        元素 2 (text):

      at tests/dimension-analysis.test.ts:88:21
          at Array.forEach (<anonymous>)

    console.log
          期望尺寸: 552.9 × 80.0

      at tests/dimension-analysis.test.ts:89:21
          at Array.forEach (<anonymous>)

    console.log
          实际尺寸: 530.8 × 76.8

      at tests/dimension-analysis.test.ts:94:21
          at Array.forEach (<anonymous>)

    console.log
          宽度比例: 0.960 (差异: -22.1px)

      at tests/dimension-analysis.test.ts:99:21
          at Array.forEach (<anonymous>)

    console.log
          高度比例: 0.960 (差异: -3.2px)

      at tests/dimension-analysis.test.ts:104:21
          at Array.forEach (<anonymous>)

    console.log


      at tests/dimension-analysis.test.ts:109:21
          at Array.forEach (<anonymous>)

    console.log
      === 统计分析 ===

      at Object.<anonymous> (tests/dimension-analysis.test.ts:115:15)

    console.log
      平均宽度比例: 0.960

      at Object.<anonymous> (tests/dimension-analysis.test.ts:131:15)

    console.log
      平均高度比例: 0.960

      at Object.<anonymous> (tests/dimension-analysis.test.ts:132:15)

    console.log
      宽度比例范围: 0.960 - 0.960

      at Object.<anonymous> (tests/dimension-analysis.test.ts:133:15)

    console.log
      高度比例范围: 0.960 - 0.960

      at Object.<anonymous> (tests/dimension-analysis.test.ts:138:15)

    console.log
      
      === 按元素类型分析 ===

      at Object.<anonymous> (tests/dimension-analysis.test.ts:145:15)

    console.log
      text 元素 (19个):

      at tests/dimension-analysis.test.ts:165:17
          at Array.forEach (<anonymous>)

    console.log
        平均宽度比例: 0.960

      at tests/dimension-analysis.test.ts:166:17
          at Array.forEach (<anonymous>)

    console.log
        平均高度比例: 0.960

      at tests/dimension-analysis.test.ts:167:17
          at Array.forEach (<anonymous>)

    console.log
      shape 元素 (3个):

      at tests/dimension-analysis.test.ts:165:17
          at Array.forEach (<anonymous>)

    console.log
        平均宽度比例: 0.960

      at tests/dimension-analysis.test.ts:166:17
          at Array.forEach (<anonymous>)

    console.log
        平均高度比例: 0.960

      at tests/dimension-analysis.test.ts:167:17
          at Array.forEach (<anonymous>)

    console.log
      image 元素 (1个):

      at tests/dimension-analysis.test.ts:165:17
          at Array.forEach (<anonymous>)

    console.log
        平均宽度比例: 0.960

      at tests/dimension-analysis.test.ts:166:17
          at Array.forEach (<anonymous>)

    console.log
        平均高度比例: 0.960

      at tests/dimension-analysis.test.ts:167:17
          at Array.forEach (<anonymous>)

    console.log
      
      === 转换常数分析 ===

      at Object.<anonymous> (tests/dimension-analysis.test.ts:171:15)

    console.log
      推荐的宽度转换因子: 0.96

      at Object.<anonymous> (tests/dimension-analysis.test.ts:177:15)

    console.log
      推荐的高度转换因子: 0.96

      at Object.<anonymous> (tests/dimension-analysis.test.ts:178:15)

    console.log
      宽度比例方差: 0.000000

      at Object.<anonymous> (tests/dimension-analysis.test.ts:192:15)

    console.log
      高度比例方差: 0.000000

      at Object.<anonymous> (tests/dimension-analysis.test.ts:193:15)

    console.log
      ✅ 检测到一致的转换比例，可能需要应用固定的转换因子

      at Object.<anonymous> (tests/dimension-analysis.test.ts:196:17)

    console.log
      
      === EMU 转换分析 ===

      at Object.<anonymous> (tests/dimension-analysis.test.ts:202:15)

    console.log
      EMU 到点的转换比例: 0.00007874015748031496

      at Object.<anonymous> (tests/dimension-analysis.test.ts:209:15)

    console.log
      如果实际尺寸是 EMU，转换到点后的期望比例: 0.000079

      at Object.<anonymous> (tests/dimension-analysis.test.ts:210:15)

    console.log
      
      === 修复建议 ===

      at Object.<anonymous> (tests/dimension-analysis.test.ts:247:15)

    console.log
      ✅ 检测到一致的转换比例，建议应用全局转换因子:

      at Object.<anonymous> (tests/dimension-analysis.test.ts:253:17)

    console.log
         宽度: actualWidth *= 1.042

      at Object.<anonymous> (tests/dimension-analysis.test.ts:254:17)

    console.log
         高度: actualHeight *= 1.042

      at Object.<anonymous> (tests/dimension-analysis.test.ts:257:17)

    console.log


      at Object.<anonymous> (tests/dimension-analysis.test.ts:260:17)

    console.log
      实施方法:

      at Object.<anonymous> (tests/dimension-analysis.test.ts:261:17)

    console.log
      1. 在解析器中找到尺寸计算逻辑

      at Object.<anonymous> (tests/dimension-analysis.test.ts:262:17)

    console.log
      2. 应用转换因子到 width 和 height

      at Object.<anonymous> (tests/dimension-analysis.test.ts:263:17)

    console.log
      3. 确保所有元素类型都应用相同的转换

      at Object.<anonymous> (tests/dimension-analysis.test.ts:264:17)

    console.log
      
      可能的问题根源:

      at Object.<anonymous> (tests/dimension-analysis.test.ts:288:15)

    console.log
      1. EMU (English Metric Units) 转换不正确

      at Object.<anonymous> (tests/dimension-analysis.test.ts:289:15)

    console.log
      2. 坐标系统的缩放比例问题

      at Object.<anonymous> (tests/dimension-analysis.test.ts:290:15)

    console.log
      3. 字体大小到尺寸的转换问题

      at Object.<anonymous> (tests/dimension-analysis.test.ts:291:15)

    console.log
      4. 不同元素类型使用不同的测量单位

      at Object.<anonymous> (tests/dimension-analysis.test.ts:292:15)

PASS tests/__tests__/json-viewer.test.tsx
PASS tests/__tests__/switch-component-integration.test.tsx
PASS tests/__tests__/pptx-image-processor-negative-offset.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 1x1

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📐 Container size: 400x300

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📍 FillRect offsets: { left: -0.04881, top: 0.06029, right: 0.30709, bottom: 0.06029 }

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-557Z.png

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-557Z.json

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 400, height: 300 }

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      🔄 Applying fillRect transform on 1x1 image

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📐 Container: 400x300

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📍 FillRect: L-4.881% T6.029% R30.709% B6.029%

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📏 Display area: 296.7x263.8

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📍 Position offset: L-20px T18px

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      🔄 Resized image to display area: 297x264

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      🔧 Rounded values: offset(-20, 18), display(297x264)

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      🔧 Handling negative offsets: L-20px T18px

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      ✂️ Cropped image: 277x264 from (20,0)

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      🔲 Composited at: L0px T18px

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📋 Final image size: 400x300

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      ✅ Processing complete: 400x300

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📋 Applied effects: [
        'fillRect stretch: {"left":-0.04881,"top":0.06029,"right":0.30709,"bottom":0.06029}',
        'transparent padding: Applied fillRect transform'
      ]

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-587Z.png

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-587Z.json

      at console.<anonymous> (node_modules/jest-mock/build/index.js:631:25)

    console.error
      ❌ PPTXImageProcessor error: Error: Expected valid width, height and channels to create a new input image
          at Sharp._createInputDescriptor (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/input.js:296:15)
          at new Sharp (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/constructor.js:391:29)
          at PPTXImageProcessor.Sharp (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/constructor.js:203:12)
          at PPTXImageProcessor.applyFillRectTransform (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/PPTXImageProcessor.ts:358:21)
          at PPTXImageProcessor.applyStretchOffset (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/PPTXImageProcessor.ts:209:31)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/pptx-image-processor-negative-offset.test.ts:286:7)

      262 |       };
      263 |     } catch (error) {
    > 264 |       console.error("❌ PPTXImageProcessor error:", error);
          |               ^
      265 |       throw new Error(
      266 |         `Image processing failed: ${
      267 |           error instanceof Error ? error.message : "Unknown error"

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:264:15)
      at Object.<anonymous> (tests/__tests__/pptx-image-processor-negative-offset.test.ts:286:7)

    console.error
      ❌ PPTXImageProcessor error: Error: Input buffer contains unsupported image format
          at Sharp.metadata (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/input.js:549:17)
          at PPTXImageProcessor.applyStretchOffset (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/PPTXImageProcessor.ts:138:36)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/pptx-image-processor-negative-offset.test.ts:310:30)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      262 |       };
      263 |     } catch (error) {
    > 264 |       console.error("❌ PPTXImageProcessor error:", error);
          |               ^
      265 |       throw new Error(
      266 |         `Image processing failed: ${
      267 |           error instanceof Error ? error.message : "Unknown error"

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:264:15)
      at Object.<anonymous> (tests/__tests__/pptx-image-processor-negative-offset.test.ts:310:7)

PASS tests/__tests__/monaco-json-editor.test.tsx
  ● Console

    console.error
      Warning: You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.
          at textarea
          at div
          at default (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-editor.test.tsx:16:17)
          at DynamicMockComponent
          at div
          at div
          at MonacoJsonEditor (/home/hhtang/ExploreProject/pptx2pptistjson/components/MonacoJsonEditor.tsx:36:3)

      137 |
      138 |     it('applies readOnly prop correctly', async () => {
    > 139 |       render(<MonacoJsonEditor data={sampleData} readOnly={false} />);
          |             ^
      140 |       
      141 |       await waitFor(() => {
      142 |         const editor = screen.getByTestId('monaco-editor');

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at checkControlledValueProps (node_modules/react-dom/cjs/react-dom.development.js:1592:7)
      at initWrapperState$2 (node_modules/react-dom/cjs/react-dom.development.js:2279:5)
      at setInitialProperties (node_modules/react-dom/cjs/react-dom.development.js:9909:7)
      at finalizeInitialChildren (node_modules/react-dom/cjs/react-dom.development.js:10950:3)
      at completeWork (node_modules/react-dom/cjs/react-dom.development.js:22232:17)
      at completeUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26632:16)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26607:5)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at Object.<anonymous> (tests/__tests__/monaco-json-editor.test.tsx:139:13)

    console.error
      Failed to copy JSON: Error: Clipboard access denied
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-editor.test.tsx:246:9)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      69 |       onCopy?.(true);
      70 |     } catch (error) {
    > 71 |       console.error("Failed to copy JSON:", error);
         |               ^
      72 |       onCopy?.(false);
      73 |     } finally {
      74 |       setCopying(false);

      at handleCopyJson (components/MonacoJsonEditor.tsx:71:15)

    console.error
      Failed to format JSON: TypeError: Converting circular structure to JSON
          --> starting at object with constructor 'Object'
          --- property 'self' closes the circle
          at JSON.stringify (<anonymous>)
          at formatJson (/home/hhtang/ExploreProject/pptx2pptistjson/components/MonacoJsonEditor.tsx:54:19)
          at MonacoJsonEditor (/home/hhtang/ExploreProject/pptx2pptistjson/components/MonacoJsonEditor.tsx:364:18)
          at renderWithHooks (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:15486:18)
          at updateFunctionComponent (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:19617:20)
          at beginWork (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:21640:16)
          at beginWork$1 (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:27465:14)
          at performUnitOfWork (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:26599:12)
          at workLoopSync (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:26505:5)
          at renderRootSync (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:26473:7)
          at performConcurrentWorkOnRoot (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:25777:74)
          at flushActQueue (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react/cjs/react.development.js:2667:24)
          at act (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react/cjs/react.development.js:2582:11)
          at /home/hhtang/ExploreProject/pptx2pptistjson/node_modules/@testing-library/react/dist/act-compat.js:47:25
          at renderRoot (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/@testing-library/react/dist/pure.js:190:26)
          at render (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/@testing-library/react/dist/pure.js:292:10)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-editor.test.tsx:324:13)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      54 |       return JSON.stringify(jsonData, null, 2);
      55 |     } catch (error) {
    > 56 |       console.error('Failed to format JSON:', error);
         |               ^
      57 |       return 'Error: Invalid JSON data';
      58 |     }
      59 |   };

      at formatJson (components/MonacoJsonEditor.tsx:56:15)
      at MonacoJsonEditor (components/MonacoJsonEditor.tsx:364:18)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom.development.js:15486:18)
      at updateFunctionComponent (node_modules/react-dom/cjs/react-dom.development.js:19617:20)
      at beginWork (node_modules/react-dom/cjs/react-dom.development.js:21640:16)
      at beginWork$1 (node_modules/react-dom/cjs/react-dom.development.js:27465:14)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26599:12)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at Object.<anonymous> (tests/__tests__/monaco-json-editor.test.tsx:324:13)

PASS tests/__tests__/file-uploader.test.tsx
  ● Console

    console.error
      Warning: Received `true` for a non-boolean attribute `jsx`.
      
      If you want to write it to the DOM, pass a string instead: jsx="true" or jsx={value.toString()}.
          at style
          at FileUploader (/home/hhtang/ExploreProject/pptx2pptistjson/components/FileUploader.tsx:10:32)

      19 |   describe('Basic Rendering', () => {
      20 |     it('renders upload button with correct text when not loading', () => {
    > 21 |       render(<FileUploader onFileUpload={mockOnFileUpload} loading={false} />);
         |             ^
      22 |       
      23 |       const button = screen.getByRole('button');
      24 |       expect(button).toBeInTheDocument();

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at validateProperty$1 (node_modules/react-dom/cjs/react-dom.development.js:3765:9)
      at warnUnknownProperties (node_modules/react-dom/cjs/react-dom.development.js:3803:21)
      at validateProperties$2 (node_modules/react-dom/cjs/react-dom.development.js:3827:3)
      at validatePropertiesInDevelopment (node_modules/react-dom/cjs/react-dom.development.js:9541:5)
      at setInitialProperties (node_modules/react-dom/cjs/react-dom.development.js:9830:5)
      at finalizeInitialChildren (node_modules/react-dom/cjs/react-dom.development.js:10950:3)
      at completeWork (node_modules/react-dom/cjs/react-dom.development.js:22232:17)
      at completeUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26632:16)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26607:5)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at Object.<anonymous> (tests/__tests__/file-uploader.test.tsx:21:13)

    console.error
      Warning: Received `true` for a non-boolean attribute `global`.
      
      If you want to write it to the DOM, pass a string instead: global="true" or global={value.toString()}.
          at style
          at FileUploader (/home/hhtang/ExploreProject/pptx2pptistjson/components/FileUploader.tsx:10:32)

      19 |   describe('Basic Rendering', () => {
      20 |     it('renders upload button with correct text when not loading', () => {
    > 21 |       render(<FileUploader onFileUpload={mockOnFileUpload} loading={false} />);
         |             ^
      22 |       
      23 |       const button = screen.getByRole('button');
      24 |       expect(button).toBeInTheDocument();

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at validateProperty$1 (node_modules/react-dom/cjs/react-dom.development.js:3765:9)
      at warnUnknownProperties (node_modules/react-dom/cjs/react-dom.development.js:3803:21)
      at validateProperties$2 (node_modules/react-dom/cjs/react-dom.development.js:3827:3)
      at validatePropertiesInDevelopment (node_modules/react-dom/cjs/react-dom.development.js:9541:5)
      at setInitialProperties (node_modules/react-dom/cjs/react-dom.development.js:9830:5)
      at finalizeInitialChildren (node_modules/react-dom/cjs/react-dom.development.js:10950:3)
      at completeWork (node_modules/react-dom/cjs/react-dom.development.js:22232:17)
      at completeUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26632:16)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom.development.js:26607:5)
      at workLoopSync (node_modules/react-dom/cjs/react-dom.development.js:26505:5)
      at renderRootSync (node_modules/react-dom/cjs/react-dom.development.js:26473:7)
      at performConcurrentWorkOnRoot (node_modules/react-dom/cjs/react-dom.development.js:25777:74)
      at flushActQueue (node_modules/react/cjs/react.development.js:2667:24)
      at act (node_modules/react/cjs/react.development.js:2582:11)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at Object.<anonymous> (tests/__tests__/file-uploader.test.tsx:21:13)

PASS tests/__tests__/color-processing-advanced.test.ts
  ● Console

    console.log
      Invalid input 0: {"a:srgbClr":{"attrs":{"val":"GGGGGG"}}} → rgba(0,0,0,1)

      at tests/__tests__/color-processing-advanced.test.ts:215:17
          at Array.forEach (<anonymous>)

    console.log
      Invalid input 1: {"a:srgbClr":{"attrs":{"val":"12345"}}} → rgba(0,0,0,1)

      at tests/__tests__/color-processing-advanced.test.ts:215:17
          at Array.forEach (<anonymous>)

    console.log
      Invalid input 2: {"a:srgbClr":{"attrs":{"val":""}}} →

      at tests/__tests__/color-processing-advanced.test.ts:215:17
          at Array.forEach (<anonymous>)

    console.log
      Invalid input 3: {"a:srgbClr":{"attrs":{"val":"invalid"}}} → rgba(0,0,0,1)

      at tests/__tests__/color-processing-advanced.test.ts:215:17
          at Array.forEach (<anonymous>)

    console.log
      minimum value (0): rgba(0,0,0,1)

      at tests/__tests__/color-processing-advanced.test.ts:260:17
          at Array.forEach (<anonymous>)

    console.log
      full value (100000): rgba(128,128,128,1)

      at tests/__tests__/color-processing-advanced.test.ts:260:17
          at Array.forEach (<anonymous>)

    console.log
      double value (200000): rgba(255,255,255,1)

      at tests/__tests__/color-processing-advanced.test.ts:260:17
          at Array.forEach (<anonymous>)

    console.log
      tiny value (1): rgba(0,0,0,1)

      at tests/__tests__/color-processing-advanced.test.ts:260:17
          at Array.forEach (<anonymous>)

    console.log
      HSL(0, 100%, 50%) → rgba(0,255,255,1)

      at tests/__tests__/color-processing-advanced.test.ts:292:17
          at Array.forEach (<anonymous>)

    console.log
      HSL(360, 100%, 50%) → rgba(255,255,255,1)

      at tests/__tests__/color-processing-advanced.test.ts:292:17
          at Array.forEach (<anonymous>)

    console.log
      HSL(180, 0%, 50%) → rgba(255,255,255,1)

      at tests/__tests__/color-processing-advanced.test.ts:292:17
          at Array.forEach (<anonymous>)

    console.log
      HSL(120, 100%, 0%) → rgba(0,0,0,1)

      at tests/__tests__/color-processing-advanced.test.ts:292:17
          at Array.forEach (<anonymous>)

    console.log
      HSL(240, 100%, 100%) → rgba(255,255,255,1)

      at tests/__tests__/color-processing-advanced.test.ts:292:17
          at Array.forEach (<anonymous>)

    console.log
      Processed 1000 color transformations in 255.12ms

      at Object.<anonymous> (tests/__tests__/color-processing-advanced.test.ts:410:15)

    console.log
      Memory increase after 10000 operations: 31.06MB

      at Object.<anonymous> (tests/__tests__/color-processing-advanced.test.ts:439:15)

PASS tests/__tests__/pptx-image-processor-comprehensive.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.error
      ❌ PPTXImageProcessor error: Error: Input buffer contains unsupported image format
          at Sharp.metadata (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/input.js:549:17)
          at PPTXImageProcessor.applyStretchOffset (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/PPTXImageProcessor.ts:138:36)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/pptx-image-processor-comprehensive.test.ts:278:30)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      262 |       };
      263 |     } catch (error) {
    > 264 |       console.error("❌ PPTXImageProcessor error:", error);
          |               ^
      265 |       throw new Error(
      266 |         `Image processing failed: ${
      267 |           error instanceof Error ? error.message : "Unknown error"

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:264:15)
      at Object.<anonymous> (tests/__tests__/pptx-image-processor-comprehensive.test.ts:278:7)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

PASS tests/__tests__/corrected-stretch-logic.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 100x100

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: 0, top: 0, right: 0, bottom: 0 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-697Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-697Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 200, height: 150 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 100x100 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L0.000% T0.000% R0.000% B0.000%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 200.0x150.0

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L0px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(0, 0), display(200x150)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔲 Composited image at position: L0px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:542:19)

    console.log
      📋 Final image size: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [ 'fillRect resize: 200x150' ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-727Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-727Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 100x100

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: 0.5, top: 0, right: 0, bottom: 0 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-748Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-748Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 200, height: 150 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 100x100 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L50.000% T0.000% R0.000% B0.000%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 100.0x150.0

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L100px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 100x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(100, 0), display(100x150)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔲 Composited image at position: L100px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:542:19)

    console.log
      📋 Final image size: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [
        'fillRect stretch: {"left":0.5,"top":0,"right":0,"bottom":0}',
        'transparent padding: Applied fillRect transform'
      ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-767Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-767Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 100x100

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: -0.5, top: 0, right: 0, bottom: 0 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-791Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-791Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 200, height: 150 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 100x100 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L-50.000% T0.000% R0.000% B0.000%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 300.0x150.0

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L-100px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 300x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(-100, 0), display(300x150)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔧 Handling negative offsets: L-100px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:423:17)

    console.log
      ✂️ Cropped image: 200x150 from (100,0)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:470:19)

    console.log
      🔲 Composited at: L0px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:473:19)

    console.log
      📋 Final image size: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [
        'fillRect stretch: {"left":-0.5,"top":0,"right":0,"bottom":0}',
        'transparent padding: Applied fillRect transform'
      ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-812Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-812Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 100x100

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: 0, top: 0.5, right: 0, bottom: 0 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-831Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-831Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 200, height: 150 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 100x100 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L0.000% T50.000% R0.000% B0.000%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 200.0x75.0

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L0px T75px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 200x75

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(0, 75), display(200x75)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔲 Composited image at position: L0px T75px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:542:19)

    console.log
      📋 Final image size: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [
        'fillRect stretch: {"left":0,"top":0.5,"right":0,"bottom":0}',
        'transparent padding: Applied fillRect transform'
      ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-859Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-859Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 100x100

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: 0.25, top: 0.25, right: 0.25, bottom: 0.25 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-883Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-883Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 200, height: 150 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 100x100 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L25.000% T25.000% R25.000% B25.000%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 100.0x75.0

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L50px T38px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 100x75

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(50, 38), display(100x75)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔲 Composited image at position: L50px T38px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:542:19)

    console.log
      📋 Final image size: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [
        'fillRect stretch: {"left":0.25,"top":0.25,"right":0.25,"bottom":0.25}',
        'transparent padding: Applied fillRect transform'
      ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-898Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-898Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

PASS tests/__tests__/cdn-file-uploader.test.tsx
  ● Console

    console.log
      ✅ PPTX uploaded to CDN: https://test-cdn.vercel-storage.com/test-123.pptx

      at handleFileChange (components/CdnFileUploader.tsx:84:19)

    console.log
      ✅ PPTX uploaded to CDN: https://test-cdn.vercel-storage.com/test-123.pptx

      at handleFileChange (components/CdnFileUploader.tsx:84:19)

    console.error
      Error uploading PPTX to CDN: Error: CDN upload failed
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/cdn-file-uploader.test.tsx:225:32)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      109 |           }
      110 |         } catch (error) {
    > 111 |           console.error("Error uploading PPTX to CDN:", error);
          |                   ^
      112 |           alert(`Failed to upload PPTX to CDN: ${error instanceof Error ? error.message : String(error)}`);
      113 |         } finally {
      114 |           setUploadingToCdn(false);

      at handleFileChange (components/CdnFileUploader.tsx:111:19)

PASS tests/__tests__/services/ErrorHandling.test.ts
PASS tests/__tests__/id-generator-pptist.test.ts
PASS tests/__tests__/default-values.test.ts
PASS tests/__tests__/slide-parser-advanced.test.ts
  ● Console

    console.log
      [Slide 1] Processing p:sp - Name: "Test Shape", ID: 1, HasBlipFill: undefined

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as test

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Test Shape", ID: 1, HasBlipFill: undefined

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

PASS tests/__tests__/transparent-fill-processing.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 20x20

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: 0, top: 0, right: 0, bottom: 0 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-56-745Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-56-745Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 200, height: 150 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 20x20 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L0.000% T0.000% R0.000% B0.000%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 200.0x150.0

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L0px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(0, 0), display(200x150)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔲 Composited image at position: L0px T0px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:542:19)

    console.log
      📋 Final image size: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [ 'fillRect resize: 200x150' ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-56-770Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-56-770Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      Applied effects: [ 'fillRect resize: 200x150' ]

      at Object.<anonymous> (tests/__tests__/transparent-fill-processing.test.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.error
      ❌ PPTXImageProcessor error: Error: Expected valid width, height and channels to create a new input image
          at Sharp._createInputDescriptor (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/input.js:296:15)
          at new Sharp (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/constructor.js:391:29)
          at PPTXImageProcessor.Sharp (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/constructor.js:203:12)
          at PPTXImageProcessor.applyFillRectTransform (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/PPTXImageProcessor.ts:358:21)
          at PPTXImageProcessor.applyStretchOffset (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/PPTXImageProcessor.ts:209:31)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/transparent-fill-processing.test.ts:324:7)

      262 |       };
      263 |     } catch (error) {
    > 264 |       console.error("❌ PPTXImageProcessor error:", error);
          |               ^
      265 |       throw new Error(
      266 |         `Image processing failed: ${
      267 |           error instanceof Error ? error.message : "Unknown error"

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:264:15)
      at Object.<anonymous> (tests/__tests__/transparent-fill-processing.test.ts:324:7)

PASS tests/__tests__/theme-inheritance-mechanism.test.ts
  ● Console

    console.log
      Theme color dk1: empty result (expected for missing theme)

      at tests/__tests__/theme-inheritance-mechanism.test.ts:158:19
          at Array.forEach (<anonymous>)

    console.log
      Theme color lt1: empty result (expected for missing theme)

      at tests/__tests__/theme-inheritance-mechanism.test.ts:158:19
          at Array.forEach (<anonymous>)

    console.log
      Theme color accent1: empty result (expected for missing theme)

      at tests/__tests__/theme-inheritance-mechanism.test.ts:158:19
          at Array.forEach (<anonymous>)

    console.log
      Theme color accent2: empty result (expected for missing theme)

      at tests/__tests__/theme-inheritance-mechanism.test.ts:158:19
          at Array.forEach (<anonymous>)

    console.log
      Theme color hlink: empty result (expected for missing theme)

      at tests/__tests__/theme-inheritance-mechanism.test.ts:158:19
          at Array.forEach (<anonymous>)

    console.log
      Mapped color tx1 → dk2: rgba(31,78,121,1)

      at tests/__tests__/theme-inheritance-mechanism.test.ts:213:17
          at Array.forEach (<anonymous>)

    console.log
      Mapped color bg1 → lt2: rgba(238,236,225,1)

      at tests/__tests__/theme-inheritance-mechanism.test.ts:213:17
          at Array.forEach (<anonymous>)

    console.log
      Complex inheritance result: rgba(255,87,51,1)

      at Object.<anonymous> (tests/__tests__/theme-inheritance-mechanism.test.ts:269:15)

    console.log
      Circular reference protection:

      at Object.<anonymous> (tests/__tests__/theme-inheritance-mechanism.test.ts:305:15)

    console.log
      Font scheme structure validation passed

      at Object.<anonymous> (tests/__tests__/theme-inheritance-mechanism.test.ts:331:15)

    console.log
      Font fallback data structure validated

      at Object.<anonymous> (tests/__tests__/theme-inheritance-mechanism.test.ts:348:15)

    console.log
      Effect scheme data structure validated

      at Object.<anonymous> (tests/__tests__/theme-inheritance-mechanism.test.ts:381:15)

    console.log
      Format scheme data structure validated

      at Object.<anonymous> (tests/__tests__/theme-inheritance-mechanism.test.ts:421:15)

    console.log
      Theme lookup performance: 76.78ms for 1000 lookups

      at Object.<anonymous> (tests/__tests__/theme-inheritance-mechanism.test.ts:462:15)

    console.log
      Malformed theme 0:

      at tests/__tests__/theme-inheritance-mechanism.test.ts:488:17
          at Array.forEach (<anonymous>)

    console.log
      Malformed theme 1:

      at tests/__tests__/theme-inheritance-mechanism.test.ts:488:17
          at Array.forEach (<anonymous>)

    console.log
      Malformed theme 2:

      at tests/__tests__/theme-inheritance-mechanism.test.ts:488:17
          at Array.forEach (<anonymous>)

    console.log
      Malformed theme 3:

      at tests/__tests__/theme-inheritance-mechanism.test.ts:488:17
          at Array.forEach (<anonymous>)

    console.log
      Malformed theme 4:

      at tests/__tests__/theme-inheritance-mechanism.test.ts:488:17
          at Array.forEach (<anonymous>)

    console.log
      Malformed theme 5:

      at tests/__tests__/theme-inheritance-mechanism.test.ts:488:17
          at Array.forEach (<anonymous>)

    console.log
      Malformed theme 6:

      at tests/__tests__/theme-inheritance-mechanism.test.ts:488:17
          at Array.forEach (<anonymous>)

    console.log
      Theme data integrity maintained

      at Object.<anonymous> (tests/__tests__/theme-inheritance-mechanism.test.ts:523:15)

PASS tests/__tests__/edge-cases.test.ts
PASS tests/background-image.test.ts
  ● Console

    console.warn
      Failed to process background image data for rId1: Error: Image not found
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/background-image.test.ts:140:89)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      154 |               }
      155 |             } catch (error) {
    > 156 |               console.warn(
          |                       ^
      157 |                 `Failed to process background image data for ${embedId}:`,
      158 |                 error
      159 |               );

      at SlideParser.parseBackground (app/lib/services/parsing/SlideParser.ts:156:23)
      at Object.<anonymous> (tests/background-image.test.ts:158:26)

    console.warn
      No relationship found for embedId: unknownRId

      39 |       if (!relationship) {
      40 |         DebugHelper.log(context, `No relationship found for embedId: ${embedId}`, "warn");
    > 41 |         console.warn(`No relationship found for embedId: ${embedId}`);
         |                 ^
      42 |         return null;
      43 |       }
      44 |

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:41:17)
      at SlideParser.parseBackground (app/lib/services/parsing/SlideParser.ts:143:61)
      at Object.<anonymous> (tests/background-image.test.ts:198:53)

    console.warn
      Failed to process background image data for rId1: Error: Corrupted image
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/background-image.test.ts:375:89)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      154 |               }
      155 |             } catch (error) {
    > 156 |               console.warn(
          |                       ^
      157 |                 `Failed to process background image data for ${embedId}:`,
      158 |                 error
      159 |               );

      at SlideParser.parseBackground (app/lib/services/parsing/SlideParser.ts:156:23)
      at Object.<anonymous> (tests/background-image.test.ts:393:26)

PASS tests/__tests__/element-processor-coordination.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Text-only element prioritization: Text processor selected

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:158:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Shape element prioritization: Shape processor selected

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:203:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Image element prioritization: Image processor selected

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:239:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Complex element prioritization: Multiple processors can handle, shape takes priority

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:302:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Shape processing result: rect

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:360:17)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Shape processor can handle ambiguous element

      at tests/__tests__/element-processor-coordination.test.ts:427:17
          at Array.forEach (<anonymous>)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Generated unique ID: UY--Z-gl6Q

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:513:19)

    console.log
      Generated unique ID: N5g5rrtQlo

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:513:19)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Processor handled problematic element successfully

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:562:23)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Processing context integrity maintained during error handling

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:624:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Memory after failed processing: 0.01MB increase

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:673:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Processed 100/100 elements in 9.96ms

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:804:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      text average processing time: 0.03ms

      at tests/__tests__/element-processor-coordination.test.ts:861:19
          at Array.forEach (<anonymous>)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      Concurrent processing: 20 elements in 0.03ms

      at Object.<anonymous> (tests/__tests__/element-processor-coordination.test.ts:924:15)

PASS tests/__tests__/core-errors.test.ts
PASS tests/integration/api-integration-background.test.ts
PASS tests/__tests__/color-processing-consistency.test.ts
  ● Console

    console.log
      Average duration: 5.85898700000007ms

      at Object.<anonymous> (tests/__tests__/color-processing-consistency.test.ts:358:15)

    console.log
      srgbClr: 5.983834999999999ms (diff: 0.12484799999992902ms)

      at tests/__tests__/color-processing-consistency.test.ts:361:17
          at Array.forEach (<anonymous>)

    console.log
      prstClr: 7.379844000000048ms (diff: 1.5208569999999781ms)

      at tests/__tests__/color-processing-consistency.test.ts:361:17
          at Array.forEach (<anonymous>)

    console.log
      hslClr: 6.834045999999944ms (diff: 0.9750589999998738ms)

      at tests/__tests__/color-processing-consistency.test.ts:361:17
          at Array.forEach (<anonymous>)

    console.log
      scrgbClr: 3.238223000000289ms (diff: 2.620763999999781ms)

      at tests/__tests__/color-processing-consistency.test.ts:361:17
          at Array.forEach (<anonymous>)

PASS tests/__tests__/text-validator-comprehensive.test.ts
PASS tests/__tests__/debug-functionality.test.ts
PASS tests/__tests__/error-handling-boundary-conditions.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.error
      ❌ PPTXImageProcessor error: Error: Input buffer contains unsupported image format
          at Sharp.metadata (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/input.js:549:17)
          at PPTXImageProcessor.applyStretchOffset (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/PPTXImageProcessor.ts:138:36)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/error-handling-boundary-conditions.test.ts:48:30)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      262 |       };
      263 |     } catch (error) {
    > 264 |       console.error("❌ PPTXImageProcessor error:", error);
          |               ^
      265 |       throw new Error(
      266 |         `Image processing failed: ${
      267 |           error instanceof Error ? error.message : "Unknown error"

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:264:15)
      at Object.<anonymous> (tests/__tests__/error-handling-boundary-conditions.test.ts:48:7)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.error
      ❌ PPTXImageProcessor error: Error: Input buffer contains unsupported image format
          at Sharp.metadata (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/input.js:549:17)
          at PPTXImageProcessor.applyStretchOffset (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/PPTXImageProcessor.ts:138:36)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/error-handling-boundary-conditions.test.ts:128:30)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      262 |       };
      263 |     } catch (error) {
    > 264 |       console.error("❌ PPTXImageProcessor error:", error);
          |               ^
      265 |       throw new Error(
      266 |         `Image processing failed: ${
      267 |           error instanceof Error ? error.message : "Unknown error"

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:264:15)
      at Object.<anonymous> (tests/__tests__/error-handling-boundary-conditions.test.ts:128:7)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.error
      ❌ PPTXImageProcessor error: Error: Input buffer contains unsupported image format
          at Sharp.metadata (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/sharp/lib/input.js:549:17)
          at PPTXImageProcessor.applyStretchOffset (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/PPTXImageProcessor.ts:138:36)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/error-handling-boundary-conditions.test.ts:208:25)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      262 |       };
      263 |     } catch (error) {
    > 264 |       console.error("❌ PPTXImageProcessor error:", error);
          |               ^
      265 |       throw new Error(
      266 |         `Image processing failed: ${
      267 |           error instanceof Error ? error.message : "Unknown error"

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:264:15)
      at Object.<anonymous> (tests/__tests__/error-handling-boundary-conditions.test.ts:208:9)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

PASS tests/__tests__/services/XmlParseService.test.ts
  ● Console

    console.log
      Performance: 10000 parses in 96.05ms

      at Object.<anonymous> (tests/__tests__/services/XmlParseService.test.ts:404:15)

    console.log
      Memory increase: -25.43MB

      at Object.<anonymous> (tests/__tests__/services/XmlParseService.test.ts:405:15)

PASS tests/pptxtojson.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:sp - Name: "Shape 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 1] Processed as shape

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 1] Processing p:pic - Name: "Image 0", ID: 9, HasBlipFill: true

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.warn
      FillRect would cause division by zero in ImageElement ZeQqeC7_jN: {
        left: 0.29807407407407405,
        top: 0.3317991769547326,
        right: 0.7019259259259258,
        bottom: 0.6682008230452674,
        widthDenominator: 1.1102230246251565e-16,
        heightDenominator: 0
      }

      126 |       
      127 |       if (widthDenominator <= 0.001 || heightDenominator <= 0.001) {
    > 128 |         console.warn(`FillRect would cause division by zero in ImageElement ${this.id}:`, {
          |                 ^
      129 |           left, top, right, bottom,
      130 |           widthDenominator, heightDenominator
      131 |         });

      at ImageElement.getStretchInfo (app/lib/models/domain/elements/ImageElement.ts:128:17)
      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:82:40)
      at ImageProcessor.process (app/lib/services/element/processors/ImageProcessor.ts:266:11)
      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:243:26)
      at SlideParser.parseElements (app/lib/services/parsing/SlideParser.ts:196:28)
      at SlideParser.parse (app/lib/services/parsing/SlideParser.ts:76:24)
      at PresentationParser.parse (app/lib/services/parsing/PresentationParser.ts:70:25)
      at InternalPPTXParser.parse (app/lib/parser/InternalPPTXParser.ts:124:35)
      at InternalPPTXParser.parseToJSON (app/lib/parser/InternalPPTXParser.ts:158:20)
      at parse (app/lib/pptxtojson.ts:11:18)
      at Object.<anonymous> (tests/pptxtojson.test.ts:51:24)

    console.log
      [Slide 1] Processed as image

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 0", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 1", ID: 4, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 2", ID: 5, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 3", ID: 6, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 4", ID: 7, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 5", ID: 8, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 6", ID: 9, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 7", ID: 10, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 8", ID: 11, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 9", ID: 12, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 10", ID: 13, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 11", ID: 14, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 12", ID: 15, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 2] Processing p:sp - Name: "Text 13", ID: 16, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 2] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 0", ID: 2, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

    console.log
      [Slide 3] Processing p:sp - Name: "Text 1", ID: 3, HasBlipFill: false

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:232:15)

    console.log
      [Slide 3] Processed as text

      at SlideParser.processNode (app/lib/services/parsing/SlideParser.ts:244:19)

PASS tests/__tests__/unit-converter-comprehensive.test.ts
PASS tests/__tests__/text-style-extractor-advanced.test.ts
PASS tests/__tests__/connection-shape-processor.test.ts
PASS tests/__tests__/line-processor-comprehensive.test.ts
PASS tests/__tests__/shape-processor-fill-integration.test.ts
PASS tests/__tests__/xml-parsing-edge-cases.test.ts
  ● Console

    console.log
      Invalid XML case 0 correctly threw error: Failed to parse XML: Empty XML content

      at tests/__tests__/xml-parsing-edge-cases.test.ts:43:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 1 correctly threw error: Failed to parse XML: Empty XML content

      at tests/__tests__/xml-parsing-edge-cases.test.ts:43:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 2 correctly threw error: Failed to parse XML: No valid root node found

      at tests/__tests__/xml-parsing-edge-cases.test.ts:43:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 3 correctly threw error: Failed to parse XML: No valid root node found

      at tests/__tests__/xml-parsing-edge-cases.test.ts:43:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 4 correctly threw error: Failed to parse XML: No valid root node found

      at tests/__tests__/xml-parsing-edge-cases.test.ts:43:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 5 handled gracefully

      at tests/__tests__/xml-parsing-edge-cases.test.ts:39:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 6 correctly threw error: Failed to parse XML: No valid root node found

      at tests/__tests__/xml-parsing-edge-cases.test.ts:43:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 7 handled gracefully

      at tests/__tests__/xml-parsing-edge-cases.test.ts:39:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 8 correctly threw error: Failed to parse XML: Unexpected close tag
      Line: 0
      Column: 19
      Char: >

      at tests/__tests__/xml-parsing-edge-cases.test.ts:43:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 9 handled gracefully

      at tests/__tests__/xml-parsing-edge-cases.test.ts:39:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 10 handled gracefully

      at tests/__tests__/xml-parsing-edge-cases.test.ts:39:19
          at Array.forEach (<anonymous>)

    console.log
      Invalid XML case 11 handled gracefully

      at tests/__tests__/xml-parsing-edge-cases.test.ts:39:19
          at Array.forEach (<anonymous>)

    console.log
      Self-closing tags handled correctly

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:74:15)

    console.log
      Mixed content handled correctly

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:100:15)

    console.log
      XML entities and special characters handled

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:130:15)

    console.log
      Encoding case 0 handled correctly

      at tests/__tests__/xml-parsing-edge-cases.test.ts:147:17
          at Array.forEach (<anonymous>)

    console.log
      Encoding case 1 handled correctly

      at tests/__tests__/xml-parsing-edge-cases.test.ts:147:17
          at Array.forEach (<anonymous>)

    console.log
      Encoding case 2 handled correctly

      at tests/__tests__/xml-parsing-edge-cases.test.ts:147:17
          at Array.forEach (<anonymous>)

    console.log
      Encoding case 3 handled correctly

      at tests/__tests__/xml-parsing-edge-cases.test.ts:147:17
          at Array.forEach (<anonymous>)

    console.log
      Namespaced XML handled correctly

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:188:15)

    console.log
      Large XML parsing: 1000 elements in 48.26ms

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:229:15)

    console.log
      Deep nesting parsing: 100 levels in 0.26ms

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:268:15)

    console.log
      Many attributes parsing: 500 attributes in 2.69ms

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:297:15)

    console.log
      Memory usage after 100 parses: 18.78MB

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:337:15)

    console.log
      Concurrent parsing: 10 operations in 0.57ms

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:368:15)

    console.log
      PowerPoint relationship XML handled correctly

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:397:15)

    console.log
      Complex PowerPoint slide XML handled correctly

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:481:15)

    console.log
      PowerPoint theme XML handled correctly

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:535:15)

    console.log
      Partial corruption recovery test completed

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:558:15)

    console.log
      Large attribute parsing: 100KB attribute in 0.64ms

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:578:15)

    console.log
      Unusual but valid XML constructs handled correctly

      at Object.<anonymous> (tests/__tests__/xml-parsing-edge-cases.test.ts:609:17)

PASS tests/__tests__/fill-extractor-comprehensive.test.ts
PASS tests/__tests__/stretch-offset-parsing.test.ts
PASS tests/__tests__/text-processor-advanced.test.ts
PASS tests/__tests__/debug-helper-comprehensive.test.ts
PASS tests/__tests__/id-uniqueness.test.ts
PASS tests/__tests__/image-processing-simplified.test.ts
  ● Console

    console.log
      PNG format signature detected correctly

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:119:15)

    console.log
      JPEG format signature detected correctly

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:126:15)

    console.log
      Unknown format handled gracefully

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:133:15)

    console.log
      Extracted image: image1.png, format: png

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:146:17)

    console.warn
      No relationship found for embedId: invalidId

      39 |       if (!relationship) {
      40 |         DebugHelper.log(context, `No relationship found for embedId: ${embedId}`, "warn");
    > 41 |         console.warn(`No relationship found for embedId: ${embedId}`);
         |                 ^
      42 |         return null;
      43 |       }
      44 |

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:41:17)
      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:154:41)

    console.log
      Invalid embed ID handled correctly

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:158:15)

    console.warn
      No relationship found for embedId: rId1

      39 |       if (!relationship) {
      40 |         DebugHelper.log(context, `No relationship found for embedId: ${embedId}`, "warn");
    > 41 |         console.warn(`No relationship found for embedId: ${embedId}`);
         |                 ^
      42 |         return null;
      43 |       }
      44 |

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:41:17)
      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:168:41)

    console.log
      Missing relationship handled correctly

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:170:15)

    console.log
      Context relationships verified

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:183:15)

    console.log
      Path resolution working correctly

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:192:15)

    console.log
      Context integrity maintained

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:207:15)

    console.error
      Error extracting image data for rId1: Error: File not found: ppt/nonexistent/image.png
          at MockFileService.extractBinaryFileAsBuffer (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/image-processing-simplified.test.ts:28:13)
          at ImageDataService.extractImageData (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageDataService.ts:61:45)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/image-processing-simplified.test.ts:221:41)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

       98 |     } catch (error) {
       99 |       DebugHelper.log(context, `Error extracting image data for ${embedId}: ${error}`, "error");
    > 100 |       console.error(`Error extracting image data for ${embedId}:`, error);
          |               ^
      101 |       return null;
      102 |     }
      103 |   }

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:100:15)
      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:221:22)

    console.log
      File service errors handled gracefully

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:225:15)

    console.warn
      No relationship found for embedId: rId1

      39 |       if (!relationship) {
      40 |         DebugHelper.log(context, `No relationship found for embedId: ${embedId}`, "warn");
    > 41 |         console.warn(`No relationship found for embedId: ${embedId}`);
         |                 ^
      42 |         return null;
      43 |       }
      44 |

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:41:17)
      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:239:22)

    console.warn
      No relationship found for embedId: rId2

      39 |       if (!relationship) {
      40 |         DebugHelper.log(context, `No relationship found for embedId: ${embedId}`, "warn");
    > 41 |         console.warn(`No relationship found for embedId: ${embedId}`);
         |                 ^
      42 |         return null;
      43 |       }
      44 |

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:41:17)
      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:240:22)

    console.warn
      Invalid relationship format for embedId: rId3 { id: 'rId3', type: 'image', target: '' }

      50 |         imagePath = relationship.target;
      51 |       } else {
    > 52 |         console.warn(`Invalid relationship format for embedId: ${embedId}`, relationship);
         |                 ^
      53 |         return null;
      54 |       }
      55 |

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:52:17)
      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:241:22)

    console.log
      Malformed relationship 1 handled correctly

      at tests/__tests__/image-processing-simplified.test.ts:246:17
          at Array.forEach (<anonymous>)

    console.log
      Malformed relationship 2 handled correctly

      at tests/__tests__/image-processing-simplified.test.ts:246:17
          at Array.forEach (<anonymous>)

    console.log
      Malformed relationship 3 handled correctly

      at tests/__tests__/image-processing-simplified.test.ts:246:17
          at Array.forEach (<anonymous>)

    console.log
      Concurrent processing handled safely

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:267:15)

    console.log
      Processed 4 images in 0.58ms

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:287:15)

    console.log
      Memory increase after 50 operations: 0.27MB

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:307:15)

    console.log
      Data consistency verified

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:321:17)

    console.log
      Image data integrity: image1.png, 16 bytes, hash: 7cddabe5...

      at Object.<anonymous> (tests/__tests__/image-processing-simplified.test.ts:340:17)

PASS tests/__tests__/connection-shape-processor-advanced.test.ts
PASS tests/__tests__/shape-element-advanced.test.ts
PASS tests/__tests__/image-processing-service-integration.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      🖼️ Processing image element test2

      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:75:17)

    console.log
      📁 Original data: png, 367 bytes

      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:76:17)

    console.log
      🔧 Applying stretch offset processing for test2

      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:108:17)

    console.log
      📐 Stretch info: {
        fillRect: { left: 0.1, top: 0.1, right: 0.1, bottom: 0.1 },
        srcRect: { left: 0.05, top: 0.05, right: 0.05, bottom: 0.05 }
      }

      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:111:17)

    console.log
      originalData.buffer <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 64 00 00 00 64 08 06 00 00 00 70 e2 95 54 00 00 00 09 70 48 59 73 00 00 03 e8 00 00 03 e8 01 ... 317 more bytes>

      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:122:15)

    console.log
      🔧 PPTXImageProcessor: Processing image 100x100

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:148:17)

    console.log
      📐 Container size: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:151:17)

    console.log
      📍 FillRect offsets: { left: 0.1, top: 0.1, right: 0.1, bottom: 0.1 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:152:17)

    console.log
      ✂️ SrcRect crop: { left: 0.05, top: 0.05, right: 0.05, bottom: 0.05 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:153:30)

    console.log
      💾 Debug image saved: debug-images/image-1-original-2025-07-04T04-05-57-559Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-1-original-2025-07-04T04-05-57-559Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      ✂️ Applied srcRect crop: 89x89

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:191:21)

    console.log
      🎯 Target rect: { x: 0, y: 0, width: 200, height: 150 }

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:205:17)

    console.log
      🔄 Applying fillRect transform on 100x100 image

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:310:15)

    console.log
      📐 Container: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:313:15)

    console.log
      📍 FillRect: L10.000% T10.000% R10.000% B10.000%

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:314:15)

    console.log
      📏 Display area: 160.0x120.0

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:339:15)

    console.log
      📍 Position offset: L20px T15px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:344:15)

    console.log
      🔄 Resized image to display area: 160x120

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:380:15)

    console.log
      🔧 Rounded values: offset(20, 15), display(160x120)

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:401:15)

    console.log
      🔲 Composited image at position: L20px T15px

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:542:19)

    console.log
      📋 Final image size: 200x150

      at PPTXImageProcessor.applyFillRectTransform (app/lib/services/images/PPTXImageProcessor.ts:554:15)

    console.log
      ✅ Processing complete: 200x150

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:235:17)

    console.log
      📋 Applied effects: [
        'srcRect crop: 89x89 from (5,5)',
        'fillRect stretch: {"left":0.1,"top":0.1,"right":0.1,"bottom":0.1}',
        'transparent padding: Applied fillRect transform'
      ]

      at PPTXImageProcessor.applyStretchOffset (app/lib/services/images/PPTXImageProcessor.ts:238:17)

    console.log
      💾 Debug image saved: debug-images/image-2-processed-2025-07-04T04-05-57-601Z.png

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:659:15)

    console.log
      📄 Metadata saved: debug-images/image-2-processed-2025-07-04T04-05-57-601Z.json

      at PPTXImageProcessor.saveDebugImage (app/lib/services/images/PPTXImageProcessor.ts:662:15)

    console.log
      processedResult {
        buffer: <Buffer 89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52 00 00 00 c8 00 00 00 96 08 06 00 00 00 9b dc c7 19 00 00 00 09 70 48 59 73 00 00 03 e8 00 00 03 e8 01 ... 702 more bytes>,
        width: 200,
        height: 150,
        format: 'png',
        processedAt: 2025-07-04T04:05:57.619Z,
        appliedEffects: [
          'srcRect crop: 89x89 from (5,5)',
          'fillRect stretch: {"left":0.1,"top":0.1,"right":0.1,"bottom":0.1}',
          'transparent padding: Applied fillRect transform'
        ]
      }

      at ImageProcessingService.createDataUrl (app/lib/services/images/ImageProcessingService.ts:316:13)

    console.log
      ✅ Stretch processing completed for test2

      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:135:17)

    console.log
      📊 Result: 200x150, 752 bytes

      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:138:17)

    console.log
      ⏱️ Processing time: 85ms

      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:141:17)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.error
      ❌ Image processing failed for test4: Error: Failed to extract image data for rIdNotExist
          at ImageProcessingService.processImageElementWithEmbedId (/home/hhtang/ExploreProject/pptx2pptistjson/app/lib/services/images/ImageProcessingService.ts:71:15)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/image-processing-service-integration.test.ts:233:22)

      155 |       };
      156 |     } catch (error) {
    > 157 |       console.error(
          |               ^
      158 |         `❌ Image processing failed for ${imageElement.getId()}:`,
      159 |         error
      160 |       );

      at ImageProcessingService.processImageElementWithEmbedId (app/lib/services/images/ImageProcessingService.ts:157:15)
      at Object.<anonymous> (tests/__tests__/image-processing-service-integration.test.ts:233:22)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

PASS tests/__tests__/color-utils-enhanced.test.ts
PASS tests/__tests__/end-to-end-conversion-flow.test.ts
  ● Console

    console.warn
      ⚠️ Stretch sample file not found: /home/hhtang/ExploreProject/pptx2pptistjson/sample/stratch/input.pptx, skipping test

      126 |       // 检查拉伸示例文件是否存在
      127 |       if (!fs.existsSync(stretchInputPath)) {
    > 128 |         console.warn(`⚠️ Stretch sample file not found: ${stretchInputPath}, skipping test`);
          |                 ^
      129 |         return;
      130 |       }
      131 |

      at Object.<anonymous> (tests/__tests__/end-to-end-conversion-flow.test.ts:128:17)

PASS tests/__tests__/font-size-calculator.test.ts
PASS tests/__tests__/shape-geometry-algorithms.test.ts
  ● Console

    console.log
      Complex Bezier path: M0,100 C0,44 44,0 100,0 C156,0 200,44 200,100 C200,156 156,200 100,200 C44,200 0,156 0,100 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:231:17

    console.log
      Arc path: M100,0 A100,100 0 0 1 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:319:17

    console.log
      Quadratic Bezier path: M 0 0 L 0 0 L 0 0 L 0 0 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:402:17

    console.log
      Detected circle path: M100,0 C154,0 200,44 200,100 C200,154 154,200 100,200 C44,200 0,154 0,100 C0,44 44,0 100,0 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:499:17

    console.log
      Shape type: ellipse

      at tests/__tests__/shape-geometry-algorithms.test.ts:500:17

    console.log
      Path formula: undefined

      at tests/__tests__/shape-geometry-algorithms.test.ts:501:17

    console.log
      Irregular shape type: rect

      at tests/__tests__/shape-geometry-algorithms.test.ts:583:17

    console.log
      Irregular pathFormula: undefined

      at tests/__tests__/shape-geometry-algorithms.test.ts:584:17

    console.log
      Irregular path: M 0 0 L 0 0 L 0 0 L 0 0 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:585:17

    console.log
      2:1 ellipse: shape=ellipse, path=M200,100 A100,100 0 1 1 Z...

      at tests/__tests__/shape-geometry-algorithms.test.ts:673:19
          at Array.forEach (<anonymous>)

    console.log
      1:2 ellipse: shape=ellipse, path=M200,100 A100,100 0 1 1 Z...

      at tests/__tests__/shape-geometry-algorithms.test.ts:673:19
          at Array.forEach (<anonymous>)

    console.log
      4:3 ellipse: shape=ellipse, path=M200,98.67 A100,98.67 0 1 1 Z...

      at tests/__tests__/shape-geometry-algorithms.test.ts:673:19
          at Array.forEach (<anonymous>)

    console.log
      1:1 circle: shape=ellipse, path=M200,100 A100,100 0 1 1 Z...

      at tests/__tests__/shape-geometry-algorithms.test.ts:673:19
          at Array.forEach (<anonymous>)

    console.log
      Rectangle (rect): M 0 0 L 200 0 L 200 200 L 0 200 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:747:19
          at Array.forEach (<anonymous>)

    console.log
      Ellipse (ellipse): M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:747:19
          at Array.forEach (<anonymous>)

    console.log
      Triangle (triangle): M 0 0 L 0 0 L 0 0 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:747:19
          at Array.forEach (<anonymous>)

    console.log
      Small square: 133.33333000000002x133.33333000000002, viewBox: [200,200], path: M 0 0 L 200 0 L 200 200 L 0 200 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:822:19
          at Array.forEach (<anonymous>)

    console.log
      Large rectangle: 1333.3333x666.66665, viewBox: [200,200], path: M 0 0 L 200 0 L 200 200 L 0 200 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:822:19
          at Array.forEach (<anonymous>)

    console.log
      Tall rectangle: 66.66666500000001x266.66666000000004, viewBox: [200,200], path: M 0 0 L 200 0 L 200 200 L 0 200 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:822:19
          at Array.forEach (<anonymous>)

    console.log
      Wide rectangle: 399.99999x99.9999975, viewBox: [200,200], path: M 0 0 L 200 0 L 200 200 L 0 200 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:822:19
          at Array.forEach (<anonymous>)

    console.log
      45 degree rotation: rotate=45°, pos=(133.33333000000002, 133.33333000000002), path=M 0 0 L 200 0 L 200 200 L 0 200 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:921:19
          at Array.forEach (<anonymous>)

    console.log
      90 degree rotation: rotate=90°, pos=(133.33333000000002, 133.33333000000002), path=M 0 0 L 200 0 L 200 200 L 0 200 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:921:19
          at Array.forEach (<anonymous>)

    console.log
      -30 degree rotation: rotate=-30°, pos=(133.33333000000002, 133.33333000000002), path=M 0 0 L 200 0 L 200 200 L 0 200 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:921:19
          at Array.forEach (<anonymous>)

    console.log
      RoundRect keypoints: [ 0.25 ]

      at tests/__tests__/shape-geometry-algorithms.test.ts:981:17

    console.log
      Default RoundRect keypoints: [ 0.125 ]

      at tests/__tests__/shape-geometry-algorithms.test.ts:1027:17

    console.log
      Malformed geometry fallback: rect M 0 0 L 0 0 L 0 0 L 0 0 Z

      at tests/__tests__/shape-geometry-algorithms.test.ts:1101:17

    console.log
      Complex path processing time: 0.39ms

      at tests/__tests__/shape-geometry-algorithms.test.ts:1185:17

    console.log
      Path length: 25 characters

      at tests/__tests__/shape-geometry-algorithms.test.ts:1186:17

PASS tests/__tests__/api-route-parse-pptx-comprehensive.test.ts
PASS tests/__tests__/image-base64.test.ts
  ● Console

    console.error
      Error extracting image data for rId1: Error: File not found
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/image-base64.test.ts:81:64)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

       98 |     } catch (error) {
       99 |       DebugHelper.log(context, `Error extracting image data for ${embedId}: ${error}`, "error");
    > 100 |       console.error(`Error extracting image data for ${embedId}:`, error);
          |               ^
      101 |       return null;
      102 |     }
      103 |   }

      at ImageDataService.extractImageData (app/lib/services/images/ImageDataService.ts:100:15)
      at Object.<anonymous> (tests/__tests__/image-base64.test.ts:92:22)

PASS tests/__tests__/color-transformation-chain.test.ts
PASS tests/__tests__/unit-converter-precision.test.ts
  ● Console

    console.log
      Input: 72pt, Result: 96pt, Expected with factor: 95.9999976pt

      at tests/__tests__/unit-converter-precision.test.ts:112:17
          at Array.forEach (<anonymous>)

    console.log
      Input: 36pt, Result: 48pt, Expected with factor: 47.9999988pt

      at tests/__tests__/unit-converter-precision.test.ts:112:17
          at Array.forEach (<anonymous>)

    console.log
      Input: 144pt, Result: 192pt, Expected with factor: 191.9999952pt

      at tests/__tests__/unit-converter-precision.test.ts:112:17
          at Array.forEach (<anonymous>)

    console.log
      Input: 18pt, Result: 24pt, Expected with factor: 23.9999994pt

      at tests/__tests__/unit-converter-precision.test.ts:112:17
          at Array.forEach (<anonymous>)

    console.log
      Small text box: 63500 EMU → 6.67 points

      at tests/__tests__/unit-converter-precision.test.ts:132:17
          at Array.forEach (<anonymous>)

    console.log
      Medium shape: 635000 EMU → 66.67 points

      at tests/__tests__/unit-converter-precision.test.ts:132:17
          at Array.forEach (<anonymous>)

    console.log
      Large image: 3175000 EMU → 333.33 points

      at tests/__tests__/unit-converter-precision.test.ts:132:17
          at Array.forEach (<anonymous>)

    console.log
      Slide width: 9144000 EMU → 960 points

      at tests/__tests__/unit-converter-precision.test.ts:132:17
          at Array.forEach (<anonymous>)

    console.log
      just under 0.5 point: 6349.5 EMU → 0.6666141565629922 points

      at tests/__tests__/unit-converter-precision.test.ts:224:17
          at Array.forEach (<anonymous>)

    console.log
      just over 0.5 point: 6350.5 EMU → 0.6667191434370079 points

      at tests/__tests__/unit-converter-precision.test.ts:224:17
          at Array.forEach (<anonymous>)

    console.log
      just under 1 point: 12699.5 EMU → 1.3332808065629922 points

      at tests/__tests__/unit-converter-precision.test.ts:224:17
          at Array.forEach (<anonymous>)

    console.log
      just over 1 point: 12700.5 EMU → 1.333385793437008 points

      at tests/__tests__/unit-converter-precision.test.ts:224:17
          at Array.forEach (<anonymous>)

    console.log
      zero (0): 0 points

      at tests/__tests__/unit-converter-precision.test.ts:259:17
          at Array.forEach (<anonymous>)

    console.log
      minimal positive (1): 0.00010498687401574803 points

      at tests/__tests__/unit-converter-precision.test.ts:259:17
          at Array.forEach (<anonymous>)

    console.log
      minimal negative (-1): -0.00010498687401574803 points

      at tests/__tests__/unit-converter-precision.test.ts:259:17
          at Array.forEach (<anonymous>)

    console.log
      fractional minimal (0.1): 0.000010498687401574804 points

      at tests/__tests__/unit-converter-precision.test.ts:259:17
          at Array.forEach (<anonymous>)

    console.log
      epsilon (2.220446049250313e-16): 2.3311768963140806e-20 points

      at tests/__tests__/unit-converter-precision.test.ts:259:17
          at Array.forEach (<anonymous>)

    console.log
      max safe integer (9007199254740991): 945637693392.232 points

      at tests/__tests__/unit-converter-precision.test.ts:275:17
          at Array.forEach (<anonymous>)

    console.log
      half max safe (4503599627370495.5): 472818846696.116 points

      at tests/__tests__/unit-converter-precision.test.ts:275:17
          at Array.forEach (<anonymous>)

    console.log
      large but safe (1000000000000000): 104986874015.74803 points

      at tests/__tests__/unit-converter-precision.test.ts:275:17
          at Array.forEach (<anonymous>)

    console.log
      NaN: NaN

      at tests/__tests__/unit-converter-precision.test.ts:295:17
          at Array.forEach (<anonymous>)

    console.log
      positive infinity: Infinity

      at tests/__tests__/unit-converter-precision.test.ts:295:17
          at Array.forEach (<anonymous>)

    console.log
      negative infinity: -Infinity

      at tests/__tests__/unit-converter-precision.test.ts:295:17
          at Array.forEach (<anonymous>)

    console.log
      Converted 100000 values in 4.85ms

      at Object.<anonymous> (tests/__tests__/unit-converter-precision.test.ts:317:15)

    console.log
      Average: 0.049μs per conversion

      at Object.<anonymous> (tests/__tests__/unit-converter-precision.test.ts:318:15)

    console.log
      small range: 0.40ms for 1000 conversions

      at tests/__tests__/unit-converter-precision.test.ts:337:17
          at Array.forEach (<anonymous>)

    console.log
      medium range: 0.24ms for 1000 conversions

      at tests/__tests__/unit-converter-precision.test.ts:337:17
          at Array.forEach (<anonymous>)

    console.log
      large range: 0.02ms for 1000 conversions

      at tests/__tests__/unit-converter-precision.test.ts:337:17
          at Array.forEach (<anonymous>)

    console.log
      Memory increase after 50000 conversions: 0.16MB

      at Object.<anonymous> (tests/__tests__/unit-converter-precision.test.ts:359:15)

    console.log
      4:3 Standard: 960.0 x 720.0 points

      at tests/__tests__/unit-converter-precision.test.ts:382:17
          at Array.forEach (<anonymous>)

    console.log
      16:9 Widescreen: 960.0 x 540.0 points

      at tests/__tests__/unit-converter-precision.test.ts:382:17
          at Array.forEach (<anonymous>)

    console.log
      16:10 Widescreen: 960.0 x 600.0 points

      at tests/__tests__/unit-converter-precision.test.ts:382:17
          at Array.forEach (<anonymous>)

    console.log
      A4 Portrait: 816.0 x 1250.0 points

      at tests/__tests__/unit-converter-precision.test.ts:382:17
          at Array.forEach (<anonymous>)

    console.log
      Title position: (72.00, 48.00) points

      at tests/__tests__/unit-converter-precision.test.ts:402:17
          at Array.forEach (<anonymous>)

    console.log
      Content start: (96.00, 192.00) points

      at tests/__tests__/unit-converter-precision.test.ts:402:17
          at Array.forEach (<anonymous>)

    console.log
      Footer position: (480.00, 672.02) points

      at tests/__tests__/unit-converter-precision.test.ts:402:17
          at Array.forEach (<anonymous>)

    console.log
      Sidebar element: (768.00, 240.00) points

      at tests/__tests__/unit-converter-precision.test.ts:402:17
          at Array.forEach (<anonymous>)

PASS tests/__tests__/integration.test.ts
PASS tests/__tests__/debug-helper.test.ts
PASS tests/__tests__/service-container-dependency-injection.test.ts
  ● Console

    console.log
      Singleton service registration test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:185:15)

    console.log
      Factory service registration test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:207:15)

    console.log
      Singleton factory service registration test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:228:15)

    console.log
      Dependency injection test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:264:15)

    console.log
      Complex dependency graph test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:307:15)

    console.log
      Lifecycle management: singleton created 1 times, non-singleton created 1 times

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:338:15)

    console.log
      Service disposal test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:357:15)

    console.log
      Null/undefined service handling test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:407:15)

    console.log
      Service override test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:426:15)

    console.log
      Service resolution performance: 0.22ms for 1000 resolutions

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:449:15)

    console.log
      Concurrent resolution test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:480:15)

    console.log
      Memory usage: 4.06MB for 500 services

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:507:15)

    console.log
      Core service types integration test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:532:15)

    console.log
      Service configuration test passed

      at Object.<anonymous> (tests/__tests__/service-container-dependency-injection.test.ts:553:15)

PASS tests/__tests__/color-format-extended.test.ts
PASS tests/models/slide-advanced-background.test.ts
PASS tests/__tests__/shape-processor-advanced.test.ts
PASS tests/__tests__/shape-style-reference.test.ts
PASS tests/__tests__/shape-custom-geometry.test.ts
PASS tests/__tests__/output-structure.test.ts
PASS tests/__tests__/theme-color-mapping.test.ts
PASS tests/__tests__/id-generator-comprehensive.test.ts
PASS tests/__tests__/fill-extractor.test.ts
PASS tests/__tests__/image-offset-adjuster-comprehensive.test.ts
PASS tests/__tests__/image-element-model-enhancements.test.ts
  ● Console

    console.warn
      Invalid offset percentages in ImageElement img6: { left: NaN, top: Infinity, right: 15, bottom: 8 }

      106 |       if (!isFinite(leftPercent) || !isFinite(topPercent) || 
      107 |           !isFinite(rightPercent) || !isFinite(bottomPercent)) {
    > 108 |         console.warn(`Invalid offset percentages in ImageElement ${this.id}:`, {
          |                 ^
      109 |           left: leftPercent, top: topPercent, right: rightPercent, bottom: bottomPercent
      110 |         });
      111 |         return undefined;

      at ImageElement.getStretchInfo (app/lib/models/domain/elements/ImageElement.ts:108:17)
      at Object.<anonymous> (tests/__tests__/image-element-model-enhancements.test.ts:100:40)

    console.warn
      FillRect would cause division by zero in ImageElement img7: {
        left: 0.6,
        top: 0.3,
        right: 0.6,
        bottom: 0.3,
        widthDenominator: -0.19999999999999996,
        heightDenominator: 0.39999999999999997
      }

      126 |       
      127 |       if (widthDenominator <= 0.001 || heightDenominator <= 0.001) {
    > 128 |         console.warn(`FillRect would cause division by zero in ImageElement ${this.id}:`, {
          |                 ^
      129 |           left, top, right, bottom,
      130 |           widthDenominator, heightDenominator
      131 |         });

      at ImageElement.getStretchInfo (app/lib/models/domain/elements/ImageElement.ts:128:17)
      at Object.<anonymous> (tests/__tests__/image-element-model-enhancements.test.ts:123:40)

PASS tests/__tests__/precision.test.ts
PASS tests/__tests__/text-processor-color-integration.test.ts
PASS tests/__tests__/color-format.test.ts
PASS tests/__tests__/advanced-color-processing.test.ts
PASS tests/__tests__/image-offset-adjuster.test.ts
PASS tests/__tests__/preset-shape-paths.test.ts
PASS tests/__tests__/line-height-extraction.test.ts
PASS tests/__tests__/text-style-multi-paragraph.test.ts
PASS tests/__tests__/roundrect-keypoints.test.ts
PASS tests/slide-background-format.test.ts
PASS tests/utils.test.ts
PASS tests/__tests__/shape-line-fill-distinction.test.ts
PASS tests/__tests__/html-converter-paragraph.test.ts
PASS tests/__tests__/shape-element-enhancements.test.ts
PASS tests/__tests__/performance-reliability-comprehensive.test.ts
  ● Console

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      性能测试结果: 325ms, 内存增长: 1MB

      at Object.<anonymous> (tests/__tests__/performance-reliability-comprehensive.test.ts:131:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      大型演示文稿测试: 100个元素, 15ms, 内存: 0MB

      at Object.<anonymous> (tests/__tests__/performance-reliability-comprehensive.test.ts:198:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      并发效率测试: 5个任务, 131ms, 内存: 1MB

      at Object.<anonymous> (tests/__tests__/performance-reliability-comprehensive.test.ts:246:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      长期运行测试: 100个文件, 1673ms, 内存增长: -7MB

      at Object.<anonymous> (tests/__tests__/performance-reliability-comprehensive.test.ts:293:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      长时间运行性能测试: 5轮, 性能比率: 0.75

      at Object.<anonymous> (tests/__tests__/performance-reliability-comprehensive.test.ts:355:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      高频率小图片测试: 50个请求, 250ms

      at Object.<anonymous> (tests/__tests__/performance-reliability-comprehensive.test.ts:387:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      大图片处理测试: 3张大图, 118ms, 内存: 0MB

      at Object.<anonymous> (tests/__tests__/performance-reliability-comprehensive.test.ts:436:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      混合尺寸批量测试: 5张图片, 8ms

      at Object.<anonymous> (tests/__tests__/performance-reliability-comprehensive.test.ts:492:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      ✅ Sharp initialized successfully for image processing

      at PPTXImageProcessor.initializeSharp (app/lib/services/images/PPTXImageProcessor.ts:100:15)

    console.log
      资源管理测试: 剩余资源 9/20, 207ms

      at Object.<anonymous> (tests/__tests__/performance-reliability-comprehensive.test.ts:533:15)

PASS tests/__tests__/monaco-json-loader-large-files.test.tsx (11.62 s)
  ● Console

    console.log
      Loading JSON from URL: https://example.com/large-file.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 15.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      🔄 Using optimized loading for large file...

      at loadJson (components/MonacoJsonLoader.tsx:112:21)

    console.log
      ✅ Large file loaded successfully (minimized format)

      at loadJson (components/MonacoJsonLoader.tsx:143:21)

    console.log
      📊 Performance note: File size is 15.00MB. For better performance with large files, consider:
                  - Using JSONLoader in view-only mode
                  - Breaking large files into smaller chunks
                  - Using streaming JSON processing

      at loadJson (components/MonacoJsonLoader.tsx:155:21)

    console.log
      Loading JSON from URL: https://example.com/very-large.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 20.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      🔄 Using optimized loading for large file...

      at loadJson (components/MonacoJsonLoader.tsx:112:21)

    console.log
      ✅ Large file loaded successfully (minimized format)

      at loadJson (components/MonacoJsonLoader.tsx:143:21)

    console.log
      📊 Performance note: File size is 20.00MB. For better performance with large files, consider:
                  - Using JSONLoader in view-only mode
                  - Breaking large files into smaller chunks
                  - Using streaming JSON processing

      at loadJson (components/MonacoJsonLoader.tsx:155:21)

    console.log
      Loading JSON from URL: https://example.com/slow-file.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 1 failed: Error [AbortError]: Request timeout
          at /home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:126:27
          at Timeout.task [as _onTimeout] (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)
          at listOnTimeout (node:internal/timers:608:17)
          at processTimers (node:internal/timers:543:7)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 1000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 2/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 2 failed: Error [AbortError]: Request timeout
          at /home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:126:27
          at Timeout.task [as _onTimeout] (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)
          at listOnTimeout (node:internal/timers:608:17)
          at processTimers (node:internal/timers:543:7)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 2000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 3/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 3 failed: Error [AbortError]: Request timeout
          at /home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:126:27
          at Timeout.task [as _onTimeout] (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jsdom/lib/jsdom/browser/Window.js:579:19)
          at listOnTimeout (node:internal/timers:608:17)
          at processTimers (node:internal/timers:543:7)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.error
      Failed to load JSON: Request timeout after 120s. This may be due to:
                          • Large file size (consider using smaller chunks)
                          • Slow network connection
                          • CDN server overload
                          • Network connectivity issues
                          
                          Try refreshing or using a smaller file.

      166 |       } catch (err) {
      167 |         const errorMessage = err instanceof Error ? err.message : String(err);
    > 168 |         console.error("Failed to load JSON:", errorMessage);
          |                 ^
      169 |         setError(`Failed to load JSON: ${errorMessage}`);
      170 |         setLoadedSource(source); // 保存source以便显示重试按钮
      171 |       } finally {

      at loadJson (components/MonacoJsonLoader.tsx:168:17)

    console.log
      Loading JSON from URL: https://example.com/timeout.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 1 failed: Error: Network timeout
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:153:46)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 1000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 2/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 2 failed: Error: Network timeout
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:153:46)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 2000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 3/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 3 failed: Error: Network timeout
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:153:46)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.error
      Failed to load JSON: Request timeout after 120s. This may be due to:
                          • Large file size (consider using smaller chunks)
                          • Slow network connection
                          • CDN server overload
                          • Network connectivity issues
                          
                          Try refreshing or using a smaller file.

      166 |       } catch (err) {
      167 |         const errorMessage = err instanceof Error ? err.message : String(err);
    > 168 |         console.error("Failed to load JSON:", errorMessage);
          |                 ^
      169 |         setError(`Failed to load JSON: ${errorMessage}`);
      170 |         setLoadedSource(source); // 保存source以便显示重试按钮
      171 |       } finally {

      at loadJson (components/MonacoJsonLoader.tsx:168:17)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 1 failed: Error: Network timeout
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:153:46)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 1000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Loading JSON from URL: https://example.com/progress-test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 5.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      Loading JSON from URL: https://example.com/retry-test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 1 failed: Error: Network error
          at /home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:300:33
          at /home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-mock/build/index.js:305:39
          at /home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-mock/build/index.js:312:13
          at mockConstructor (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-mock/build/index.js:102:19)
          at fetchWithTimeout (/home/hhtang/ExploreProject/pptx2pptistjson/components/MonacoJsonLoader.tsx:59:40)
          at loadJson (/home/hhtang/ExploreProject/pptx2pptistjson/components/MonacoJsonLoader.tsx:100:34)
          at /home/hhtang/ExploreProject/pptx2pptistjson/components/MonacoJsonLoader.tsx:177:5
          at commitHookEffectListMount (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:23189:26)
          at commitPassiveMountOnFiber (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:24970:11)
          at commitPassiveMountEffects_complete (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:24930:9)
          at commitPassiveMountEffects_begin (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:24917:7)
          at commitPassiveMountEffects (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:24905:3)
          at flushPassiveEffectsImpl (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:27078:3)
          at flushPassiveEffects (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:27023:14)
          at /home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react-dom/cjs/react-dom.development.js:26808:9
          at flushActQueue (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react/cjs/react.development.js:2667:24)
          at act (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/react/cjs/react.development.js:2582:11)
          at /home/hhtang/ExploreProject/pptx2pptistjson/node_modules/@testing-library/react/dist/act-compat.js:47:25
          at renderRoot (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/@testing-library/react/dist/pure.js:190:26)
          at render (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/@testing-library/react/dist/pure.js:292:10)
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:315:13)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 1000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 2/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 2 failed: Error: Network error
          at /home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:300:33
          at /home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-mock/build/index.js:305:39
          at /home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-mock/build/index.js:312:13
          at mockConstructor (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-mock/build/index.js:102:19)
          at fetchWithTimeout (/home/hhtang/ExploreProject/pptx2pptistjson/components/MonacoJsonLoader.tsx:59:40)
          at loadJson (/home/hhtang/ExploreProject/pptx2pptistjson/components/MonacoJsonLoader.tsx:100:28)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 2000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 2/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      Loading JSON from URL: https://example.com/always-fail.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 1 failed: Error: Persistent network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:326:46)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 1000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 2/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 2 failed: Error: Persistent network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:326:46)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 2000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 3/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 3 failed: Error: Persistent network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:326:46)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.error
      Failed to load JSON: Persistent network error

      166 |       } catch (err) {
      167 |         const errorMessage = err instanceof Error ? err.message : String(err);
    > 168 |         console.error("Failed to load JSON:", errorMessage);
          |                 ^
      169 |         setError(`Failed to load JSON: ${errorMessage}`);
      170 |         setLoadedSource(source); // 保存source以便显示重试按钮
      171 |       } finally {

      at loadJson (components/MonacoJsonLoader.tsx:168:17)

    console.log
      Attempt 3/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 3 failed: Error: Persistent network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader-large-files.test.tsx:326:46)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.error
      Failed to load JSON: Persistent network error

      166 |       } catch (err) {
      167 |         const errorMessage = err instanceof Error ? err.message : String(err);
    > 168 |         console.error("Failed to load JSON:", errorMessage);
          |                 ^
      169 |         setError(`Failed to load JSON: ${errorMessage}`);
      170 |         setLoadedSource(source); // 保存source以便显示重试按钮
      171 |       } finally {

      at loadJson (components/MonacoJsonLoader.tsx:168:17)

PASS tests/__tests__/monaco-json-loader.test.tsx (13.514 s)
  ● Console

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 1 failed: Error: Network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:196:35)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 1000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 2/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 2 failed: Error: Network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:196:35)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 2000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 3/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 3 failed: Error: Network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:196:35)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.error
      Failed to load JSON: Network error

      166 |       } catch (err) {
      167 |         const errorMessage = err instanceof Error ? err.message : String(err);
    > 168 |         console.error("Failed to load JSON:", errorMessage);
          |                 ^
      169 |         setError(`Failed to load JSON: ${errorMessage}`);
      170 |         setLoadedSource(source); // 保存source以便显示重试按钮
      171 |       } finally {

      at loadJson (components/MonacoJsonLoader.tsx:168:17)

    console.log
      Loading JSON from URL: https://example.com/large-file.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 15.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      🔄 Using optimized loading for large file...

      at loadJson (components/MonacoJsonLoader.tsx:112:21)

    console.log
      ✅ Large file loaded successfully (minimized format)

      at loadJson (components/MonacoJsonLoader.tsx:143:21)

    console.log
      📊 Performance note: File size is 15.00MB. For better performance with large files, consider:
                  - Using JSONLoader in view-only mode
                  - Breaking large files into smaller chunks
                  - Using streaming JSON processing

      at loadJson (components/MonacoJsonLoader.tsx:155:21)

    console.log
      Loading JSON from URL: https://example.com/large-file.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 12.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      🔄 Using optimized loading for large file...

      at loadJson (components/MonacoJsonLoader.tsx:112:21)

    console.error
      Warning: An update to MonacoJsonLoader inside a test was not wrapped in act(...).
      
      When testing, code that causes React state updates should be wrapped into act(...):
      
      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */
      
      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
          at MonacoJsonLoader (/home/hhtang/ExploreProject/pptx2pptistjson/components/MonacoJsonLoader.tsx:25:3)

      115 |             // 分块处理大文件
      116 |             const text = await response.text();
    > 117 |             setLoadingProgress("Parsing JSON data...");
          |             ^
      118 |             
      119 |             // 使用Web Worker或requestIdleCallback进行异步解析
      120 |             const data = await new Promise((resolve, reject) => {

      at printWarning (node_modules/react-dom/cjs/react-dom.development.js:86:30)
      at error (node_modules/react-dom/cjs/react-dom.development.js:60:7)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom.development.js:27628:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom.development.js:25547:5)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom.development.js:16708:7)
      at loadJson (components/MonacoJsonLoader.tsx:117:13)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 1 failed: Error: Network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:287:32)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 1000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      ✅ Large file loaded successfully (minimized format)

      at loadJson (components/MonacoJsonLoader.tsx:143:21)

    console.log
      📊 Performance note: File size is 12.00MB. For better performance with large files, consider:
                  - Using JSONLoader in view-only mode
                  - Breaking large files into smaller chunks
                  - Using streaming JSON processing

      at loadJson (components/MonacoJsonLoader.tsx:155:21)

    console.log
      Attempt 2/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 2 failed: Error: Network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:288:32)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 2000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 3/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 1 failed: Error [AbortError]: timeout
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:311:28)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 1000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 2/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 2 failed: Error [AbortError]: timeout
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:311:28)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 2000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 3/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 3 failed: Error [AbortError]: timeout
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:311:28)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.error
      Failed to load JSON: Request timeout after 120s. This may be due to:
                          • Large file size (consider using smaller chunks)
                          • Slow network connection
                          • CDN server overload
                          • Network connectivity issues
                          
                          Try refreshing or using a smaller file.

      166 |       } catch (err) {
      167 |         const errorMessage = err instanceof Error ? err.message : String(err);
    > 168 |         console.error("Failed to load JSON:", errorMessage);
          |                 ^
      169 |         setError(`Failed to load JSON: ${errorMessage}`);
      170 |         setLoadedSource(source); // 保存source以便显示重试按钮
      171 |       } finally {

      at loadJson (components/MonacoJsonLoader.tsx:168:17)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 1 failed: Error: Network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:328:35)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 1000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 2/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 2 failed: Error: Network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:328:35)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.log
      Retrying in 2000ms...

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:93:25)

    console.log
      Attempt 3/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.warn
      Fetch attempt 3 failed: Error: Network error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:328:35)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      73 |                 return response;
      74 |               } catch (error) {
    > 75 |                 console.warn(`Fetch attempt ${attempt} failed:`, error);
         |                         ^
      76 |                 
      77 |                 if (attempt === retries) {
      78 |                   // 为超时错误提供更详细的信息

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:75:25)
      at loadJson (components/MonacoJsonLoader.tsx:100:28)

    console.error
      Failed to load JSON: Network error

      166 |       } catch (err) {
      167 |         const errorMessage = err instanceof Error ? err.message : String(err);
    > 168 |         console.error("Failed to load JSON:", errorMessage);
          |                 ^
      169 |         setError(`Failed to load JSON: ${errorMessage}`);
      170 |         setLoadedSource(source); // 保存source以便显示重试按钮
      171 |       } finally {

      at loadJson (components/MonacoJsonLoader.tsx:168:17)

    console.log
      🔄 Manual refresh triggered for CDN URL

      at refreshFromUrl (components/MonacoJsonLoader.tsx:212:15)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.log
      🔄 Manual refresh triggered for CDN URL

      at refreshFromUrl (components/MonacoJsonLoader.tsx:212:15)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.error
      Failed to copy JSON: Error: Clipboard error
          at Object.<anonymous> (/home/hhtang/ExploreProject/pptx2pptistjson/tests/__tests__/monaco-json-loader.test.tsx:466:39)
          at Promise.finally.completed (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1559:28)
          at new Promise (<anonymous>)
          at callAsyncCircusFn (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1499:10)
          at _callCircusTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1009:40)
          at _runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:949:3)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:839:13)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at _runTestsForDescribeBlock (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:829:11)
          at run (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:757:3)
          at runAndTransformResultsToJestFormat (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/jestAdapterInit.js:1920:21)
          at jestAdapter (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-circus/build/runner.js:101:19)
          at runTestInternal (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:272:16)
          at runTest (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:340:7)
          at Object.worker (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jest-runner/build/testWorker.js:494:12)

      203 |       alert("JSON copied to clipboard!");
      204 |     } catch (err) {
    > 205 |       console.error("Failed to copy JSON:", err);
          |               ^
      206 |       alert("Failed to copy JSON to clipboard");
      207 |     }
      208 |   };

      at copyToClipboard (components/MonacoJsonLoader.tsx:205:15)

    console.log
      Loading JSON from URL: https://example.com/invalid.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.error
      Failed to load JSON: Invalid JSON

      166 |       } catch (err) {
      167 |         const errorMessage = err instanceof Error ? err.message : String(err);
    > 168 |         console.error("Failed to load JSON:", errorMessage);
          |                 ^
      169 |         setError(`Failed to load JSON: ${errorMessage}`);
      170 |         setLoadedSource(source); // 保存source以便显示重试按钮
      171 |       } finally {

      at loadJson (components/MonacoJsonLoader.tsx:168:17)

    console.error
      Error: Not implemented: navigation (except hash changes)
          at module.exports (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jsdom/lib/jsdom/browser/not-implemented.js:9:17)
          at navigateFetch (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
          at exports.navigate (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
          at Timeout._onTimeout (/home/hhtang/ExploreProject/pptx2pptistjson/node_modules/jsdom/lib/jsdom/living/nodes/HTMLHyperlinkElementUtils-impl.js:80:7)
          at listOnTimeout (node:internal/timers:608:17)
          at processTimers (node:internal/timers:543:7) {
        type: 'not implemented'
      }

      at VirtualConsole.<anonymous> (node_modules/@jest/environment-jsdom-abstract/build/index.js:78:23)
      at module.exports (node_modules/jsdom/lib/jsdom/browser/not-implemented.js:12:26)
      at navigateFetch (node_modules/jsdom/lib/jsdom/living/window/navigation.js:77:3)
      at exports.navigate (node_modules/jsdom/lib/jsdom/living/window/navigation.js:55:3)
      at Timeout._onTimeout (node_modules/jsdom/lib/jsdom/living/nodes/HTMLHyperlinkElementUtils-impl.js:80:7)

    console.log
      Loading JSON from URL: https://example.com/malformed.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)

    console.log
      Loading JSON file: 0.00MB

      at loadJson (components/MonacoJsonLoader.tsx:107:19)

    console.error
      Failed to load JSON: Invalid JSON

      166 |       } catch (err) {
      167 |         const errorMessage = err instanceof Error ? err.message : String(err);
    > 168 |         console.error("Failed to load JSON:", errorMessage);
          |                 ^
      169 |         setError(`Failed to load JSON: ${errorMessage}`);
      170 |         setLoadedSource(source); // 保存source以便显示重试按钮
      171 |       } finally {

      at loadJson (components/MonacoJsonLoader.tsx:168:17)

    console.log
      Loading JSON from URL: https://example.com/test.json

      at loadJson (components/MonacoJsonLoader.tsx:47:19)

    console.log
      Attempt 1/3 to fetch JSON from CDN

      at fetchWithTimeout (components/MonacoJsonLoader.tsx:53:25)


Summary of all failing tests
FAIL tests/__tests__/html-output-integrity.test.ts
  ● HTML Output Integrity Tests › Output Format Consistency › should match expected output.json format exactly

    expect(received).toContain(expected) // indexOf

    Expected substring: "color:#5b9bd5ff;font-size:54px;font-weight:bold;--colortype:accent1"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:54px;color:#5b9bd5ff;font-weight:bold;--colortype:accent1\">党建宣传策略实战方法论</span></p></div>"

      384 |       expect(json.content).toContain('<div style="">'); // Note: fixed space
      385 |       expect(json.content).toContain('<p style="">'); // Note: fixed space
    > 386 |       expect(json.content).toContain(
          |                            ^
      387 |         "color:#5b9bd5ff;font-size:54px;font-weight:bold;--colortype:accent1"
      388 |       );
      389 |     });

      at Object.<anonymous> (tests/__tests__/html-output-integrity.test.ts:386:28)

FAIL tests/__tests__/html-converter-comprehensive.test.ts
  ● HtmlConverter - Comprehensive Test Suite › Single Paragraph Conversion › should convert simple text content to HTML

    expect(received).toBe(expected) // Object.is equality

    Expected: "<div style=\"\"><p style=\"\"><span style=\"\">Hello World</span></p></div>"
    Received: "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">Hello World</span></p></div>"

      15 |       
      16 |       const html = HtmlConverter.convertSingleParagraphToHtml(content);
    > 17 |       expect(html).toBe('<div style=""><p style=""><span style="">Hello World</span></p></div>');
         |                    ^
      18 |     });
      19 |
      20 |     it('should handle text with basic styling', () => {

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:17:20)

  ● HtmlConverter - Comprehensive Test Suite › Single Paragraph Conversion › should handle multiple text runs in a paragraph

    expect(received).toContain(expected) // indexOf

    Expected substring: "<span style=\"\">Normal </span>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">Normal </span><span style=\"font-size:23.99px;font-weight:bold\">Bold </span><span style=\"font-size:23.99px;font-style:italic\">Italic</span></p></div>"

      78 |       
      79 |       const html = HtmlConverter.convertSingleParagraphToHtml(content);
    > 80 |       expect(html).toContain('<span style="">Normal </span>');
         |                    ^
      81 |       expect(html).toContain('<span style="font-weight:bold">Bold </span>');
      82 |       expect(html).toContain('<span style="font-style:italic">Italic</span>');
      83 |     });

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:80:20)

  ● HtmlConverter - Comprehensive Test Suite › Single Paragraph Conversion › should handle options without wrapping div

    expect(received).toBe(expected) // Object.is equality

    Expected: "<p style=\"\"><span style=\"\">No Wrapper</span></p>"
    Received: "<p style=\"\"><span style=\"font-size:23.99px\">No Wrapper</span></p>"

      90 |       const options: HtmlConversionOptions = { wrapInDiv: false };
      91 |       const html = HtmlConverter.convertSingleParagraphToHtml(content, options);
    > 92 |       expect(html).toBe('<p style=""><span style="">No Wrapper</span></p>');
         |                    ^
      93 |     });
      94 |
      95 |     it('should handle custom div style', () => {

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:92:20)

  ● HtmlConverter - Comprehensive Test Suite › Multiple Paragraphs Conversion › should convert multiple paragraphs to HTML

    expect(received).toContain(expected) // indexOf

    Expected substring: "<p style=\"\"><span style=\"\">First paragraph</span></p>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">First paragraph</span></p><p style=\"\"><span style=\"font-size:23.99px\">Second paragraph</span></p><p style=\"\"><span style=\"font-size:23.99px\">Third paragraph</span></p></div>"

      142 |       
      143 |       const html = HtmlConverter.convertParagraphsToHtml(paragraphs);
    > 144 |       expect(html).toContain('<p style=""><span style="">First paragraph</span></p>');
          |                    ^
      145 |       expect(html).toContain('<p style=""><span style="">Second paragraph</span></p>');
      146 |       expect(html).toContain('<p style=""><span style="">Third paragraph</span></p>');
      147 |     });

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:144:20)

  ● HtmlConverter - Comprehensive Test Suite › Multiple Paragraphs Conversion › should handle mixed paragraph styles

    expect(received).toContain(expected) // indexOf

    Expected substring: "<span style=\"\">Normal</span>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">Normal</span></p><p style=\"\"><span style=\"font-size:23.99px;font-weight:bold\">Bold</span></p><p style=\"\"><span style=\"font-size:23.99px;font-style:italic\">Italic</span></p></div>"

      155 |       
      156 |       const html = HtmlConverter.convertParagraphsToHtml(paragraphs);
    > 157 |       expect(html).toContain('<span style="">Normal</span>');
          |                    ^
      158 |       expect(html).toContain('<span style="font-weight:bold">Bold</span>');
      159 |       expect(html).toContain('<span style="font-style:italic">Italic</span>');
      160 |     });

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:157:20)

  ● HtmlConverter - Comprehensive Test Suite › Multiple Paragraphs Conversion › should handle options without wrapping div for multiple paragraphs

    expect(received).toBe(expected) // Object.is equality

    Expected: "<p style=\"\"><span style=\"\">Para 1</span></p><p style=\"\"><span style=\"\">Para 2</span></p>"
    Received: "<p style=\"\"><span style=\"font-size:23.99px\">Para 1</span></p><p style=\"\"><span style=\"font-size:23.99px\">Para 2</span></p>"

      194 |       const options: HtmlConversionOptions = { wrapInDiv: false };
      195 |       const html = HtmlConverter.convertParagraphsToHtml(paragraphs, options);
    > 196 |       expect(html).toBe('<p style=""><span style="">Para 1</span></p><p style=""><span style="">Para 2</span></p>');
          |                    ^
      197 |     });
      198 |   });
      199 |

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:196:20)

  ● HtmlConverter - Comprehensive Test Suite › HTML Escaping › should handle null and undefined text gracefully

    expect(received).toContain(expected) // indexOf

    Expected substring: "<span style=\"\"></span>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\"></span></p></div>"

      308 |       const options: HtmlConversionOptions = { escapeHtml: true };
      309 |       const html = HtmlConverter.convertSingleParagraphToHtml(content, options);
    > 310 |       expect(html).toContain('<span style=""></span>');
          |                    ^
      311 |     });
      312 |   });
      313 |

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:310:20)

  ● HtmlConverter - Comprehensive Test Suite › Style Ordering and Formatting › should maintain correct style order

    expect(received).toContain(expected) // indexOf

    Expected substring: "color:"
    Received string:    "font-size:16px"

      337 |       const styles = styleContent.split(';');
      338 |       
    > 339 |       expect(styles[0]).toContain('color:');
          |                         ^
      340 |       expect(styles[1]).toContain('font-size:');
      341 |       expect(styles[2]).toContain('font-weight:');
      342 |       expect(styles[3]).toContain('font-style:');

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:339:25)

  ● HtmlConverter - Comprehensive Test Suite › Edge Cases and Error Handling › should handle content with only empty text

    expect(received).toBe(expected) // Object.is equality

    Expected: "<div style=\"\"><p style=\"\"><span style=\"\"></span></p></div>"
    Received: "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\"></span></p></div>"

      448 |       
      449 |       const html = HtmlConverter.convertSingleParagraphToHtml(content);
    > 450 |       expect(html).toBe('<div style=""><p style=""><span style=""></span></p></div>');
          |                    ^
      451 |     });
      452 |
      453 |     it('should handle content with only whitespace', () => {

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:450:20)

  ● HtmlConverter - Comprehensive Test Suite › Edge Cases and Error Handling › should handle content with only whitespace

    expect(received).toContain(expected) // indexOf

    Expected substring: "<span style=\"\">   </span>"
    Received string:    "<div style=\"\"><p style=\"\"><span style=\"font-size:23.99px\">   </span></p></div>"

      457 |       
      458 |       const html = HtmlConverter.convertSingleParagraphToHtml(content);
    > 459 |       expect(html).toContain('<span style="">   </span>');
          |                    ^
      460 |     });
      461 |
      462 |     it('should handle very long text content', () => {

      at Object.<anonymous> (tests/__tests__/html-converter-comprehensive.test.ts:459:20)


Test Suites: 2 failed, 90 passed, 92 total
Tests:       11 failed, 1741 passed, 1752 total
Snapshots:   0 total
Time:        15.167 s
Ran all test suites.
